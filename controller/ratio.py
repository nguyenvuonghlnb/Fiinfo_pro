import service
import database
import time
import telegram
from datetime import datetime

BASE_URL = "http://df31.fiintek.com"
DATE_TYPE = "tradingdate"


def get_ratio_IcbIndustry(date_request):
    # Init parameter
    if not date_request:  # Nếu không truyền ngày thì mặc định lấy ngày hiện tại
        date_request = datetime.now().strftime("%Y-%m-%d")
    page_index = 1
    page_size = 100
    url = BASE_URL + "/Ratio/GetRatioIcbIndustry?pageIndex=" + str(page_index) \
          + "&pageSize=" + str(page_size) \
          + "&DateType=" + DATE_TYPE + "&fromDate=" + date_request + "&toDate=" + date_request
    print("[get_ratio_IcbIndustry] get date >> ", url)
    response = service.make_request(url)
    if response is None:
        return

    data = response["Data"]
    paging = response["Paging"]

    while paging.get("NextPage") is not None:
        time.sleep(10)
        print("[get_ratio_IcbIndustry] NextPage : %s in TotalPage : %s", paging.get("NextPage"),
              paging.get("TotalPage"))
        url = BASE_URL + "/Ratio/GetRatioIcbIndustry?pageIndex=" + str(paging.get("NextPage")) \
              + "&pageSize=" + str(page_size) \
              + "&DateType=" + DATE_TYPE + "&fromDate=" + date_request + "&toDate=" + date_request
        print("[get_ratio_IcbIndustry] Next page found >> ", url)
        response = service.make_request(url)
        data = data + response["Data"]
        paging = response["Paging"]

        print("[get_ratio_IcbIndustry] Data size: ", len(data))
    database.execute_many('''INSERT INTO fiin_dtf.stx_rto_ratioicbindustry (RatioIcbIndustryId, IcbCode, 
    ComGroupCode, TradingDate, Status, CreateDate, UpdateDate, RSD1, RSD2, RSD3, RSD4, RSD5, RSD6, RSD7, RSD8, RSD9, 
    RSD10, RSD11, RSD12, RSD13, RSD14, RSD15, RSD16, RSD17, RSD18, RSD19, RSD20, RSD21, RSD22, RSD23, RSD24, RSD25, 
    RSD26, RSD27, RSD28, RSD29, RSD30, RSD31, RSD32, RSD33, RSD34, RSD35, RSD36, RSD37, RSD38, RSD39, RSD40, RSD41, 
    RSD42, RSD43, RSD44, RSD45, RSD46, RSD47, RSD48, RSD49,RSQ1, RSQ2, RSQ3, RSQ4, RSQ5, RSQ6, RSQ7, RSQ8, RSQ9, 
    RSQ10, RSQ11, RSQ12, RSQ13, RSQ14, RSQ15, RSQ16, RSQ17, RSQ18, RSQ19, RSQ20, RSQ21, RSQ22, RSQ23, RSQ24, RSQ25, 
    RSQ26, RSQ27, RSQ28, RSQ29, RSQ30, RSQ31, RSQ32, RSQ33, RSQ34, RSQ35, RSQ36, RSQ37, RSQ38, RSQ39, RSQ40, RSQ41, 
    RSQ42, RSQ43, RSQ44, RSQ45, RSQ46, RSQ47, RSQ48, RSQ49, RSQ50, RSQ51, RSQ52, RSQ53, RSQ54, RSQ55, RSQ56, RSQ57, 
    RSQ58, RSQ59, RSQ60, RSQ61, RSQ62, RSQ63, RSQ64, RSQ65, RSQ66, RSQ67, RSQ68, RSQ69, RSQ70, RSQ71, RSQ72, RSQ73, 
    RSQ74, RSQ75, RSQ76, RSQ77, RSQ78, RSQ79, RSQ80, RSQ81, RSQ82, RSQ83, RSQ84, RSQ85, RSQ86, RSQ87, RSQ88, RSQ89, 
    RSQ90, RSQ91, RSQ92, RSQ93, RSQ94, RSQ95, RSQ96, RSQ97, RSQ98, RSQ99, RSQ100, RSQ101, RSQ102, RSQ103, RSQ104, 
    RSQ105, RSQ106, RSQ107, RSQ108, RSQ109, RSQ110, RSQ111, RSQ112, RSQ113, RSQ114, RSQ115, RSQ116, RSQ117, RSQ118, 
    RSQ119, RSQ120, RSQ121, RSQ122, RSQ123, RSQ124, RSQ125, RSQ126, RSQ127, RSQ128, RSQ129, RSQ130, RSQ131, RSQ132, 
    RSQ133, RSQ134, RSQ135, RSQ136, RSQ137, RSQ138, RSQ139, RSQ140, RSQ141, RSQ142, RSQ143, RSQ144, RSQ145, RSQ146, 
    RSQ147, RSQ148, RSD50, RSD51, RSD52, RSD53, RSD54, RSD55) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s) ON CONFLICT ON CONSTRAINT xpkstx_fsc_ratioicbindustry DO UPDATE SET (RatioIcbIndustryId, IcbCode, 
    ComGroupCode, TradingDate, Status, CreateDate, UpdateDate, RSD1, RSD2, RSD3, RSD4, RSD5, RSD6, RSD7, RSD8, RSD9, 
    RSD10, RSD11, RSD12, RSD13, RSD14, RSD15, RSD16, RSD17, RSD18, RSD19, RSD20, RSD21, RSD22, RSD23, RSD24, RSD25, 
    RSD26, RSD27, RSD28, RSD29, RSD30, RSD31, RSD32, RSD33, RSD34, RSD35, RSD36, RSD37, RSD38, RSD39, RSD40, RSD41, 
    RSD42, RSD43, RSD44, RSD45, RSD46, RSD47, RSD48, RSD49,RSQ1, RSQ2, RSQ3, RSQ4, RSQ5, RSQ6, RSQ7, RSQ8, RSQ9, 
    RSQ10, RSQ11, RSQ12, RSQ13, RSQ14, RSQ15, RSQ16, RSQ17, RSQ18, RSQ19, RSQ20, RSQ21, RSQ22, RSQ23, RSQ24, RSQ25, 
    RSQ26, RSQ27, RSQ28, RSQ29, RSQ30, RSQ31, RSQ32, RSQ33, RSQ34, RSQ35, RSQ36, RSQ37, RSQ38, RSQ39, RSQ40, RSQ41, 
    RSQ42, RSQ43, RSQ44, RSQ45, RSQ46, RSQ47, RSQ48, RSQ49, RSQ50, RSQ51, RSQ52, RSQ53, RSQ54, RSQ55, RSQ56, RSQ57, 
    RSQ58, RSQ59, RSQ60, RSQ61, RSQ62, RSQ63, RSQ64, RSQ65, RSQ66, RSQ67, RSQ68, RSQ69, RSQ70, RSQ71, RSQ72, RSQ73, 
    RSQ74, RSQ75, RSQ76, RSQ77, RSQ78, RSQ79, RSQ80, RSQ81, RSQ82, RSQ83, RSQ84, RSQ85, RSQ86, RSQ87, RSQ88, RSQ89, 
    RSQ90, RSQ91, RSQ92, RSQ93, RSQ94, RSQ95, RSQ96, RSQ97, RSQ98, RSQ99, RSQ100, RSQ101, RSQ102, RSQ103, RSQ104, 
    RSQ105, RSQ106, RSQ107, RSQ108, RSQ109, RSQ110, RSQ111, RSQ112, RSQ113, RSQ114, RSQ115, RSQ116, RSQ117, RSQ118, 
    RSQ119, RSQ120, RSQ121, RSQ122, RSQ123, RSQ124, RSQ125, RSQ126, RSQ127, RSQ128, RSQ129, RSQ130, RSQ131, RSQ132, 
    RSQ133, RSQ134, RSQ135, RSQ136, RSQ137, RSQ138, RSQ139, RSQ140, RSQ141, RSQ142, RSQ143, RSQ144, RSQ145, RSQ146, 
    RSQ147, RSQ148, RSD50, RSD51, RSD52, RSD53, RSD54, RSD55) = (EXCLUDED.RatioIcbIndustryId, EXCLUDED.IcbCode, 
    EXCLUDED.ComGroupCode, EXCLUDED. TradingDate, EXCLUDED.Status, EXCLUDED.CreateDate, EXCLUDED.UpdateDate, 
    EXCLUDED.RSD1, EXCLUDED.RSD2, EXCLUDED.RSD3, EXCLUDED.RSD4, EXCLUDED.RSD5, EXCLUDED.RSD6, EXCLUDED.RSD7, 
    EXCLUDED.RSD8, EXCLUDED.RSD9, EXCLUDED.RSD10, EXCLUDED. RSD11, EXCLUDED.RSD12, EXCLUDED.RSD13, EXCLUDED.RSD14, 
    EXCLUDED.RSD15, EXCLUDED.RSD16, EXCLUDED.RSD17, EXCLUDED.RSD18, EXCLUDED.RSD19, EXCLUDED.RSD20, EXCLUDED.RSD21, 
    EXCLUDED.RSD22, EXCLUDED.RSD23, EXCLUDED.RSD24, EXCLUDED.RSD25, EXCLUDED. RSD26, EXCLUDED.RSD27, EXCLUDED.RSD28, 
    EXCLUDED.RSD29, EXCLUDED.RSD30, EXCLUDED.RSD31, EXCLUDED.RSD32, EXCLUDED.RSD33, EXCLUDED.RSD34, EXCLUDED.RSD35, 
    EXCLUDED.RSD36, EXCLUDED.RSD37, EXCLUDED.RSD38, EXCLUDED.RSD39, EXCLUDED.RSD40, EXCLUDED. RSD41, EXCLUDED.RSD42, 
    EXCLUDED.RSD43, EXCLUDED.RSD44, EXCLUDED.RSD45, EXCLUDED.RSD46, EXCLUDED.RSD47, EXCLUDED.RSD48, EXCLUDED.RSD49,
    EXCLUDED.RSQ1, EXCLUDED.RSQ2, EXCLUDED.RSQ3, EXCLUDED.RSQ4, EXCLUDED.RSQ5, EXCLUDED.RSQ6, EXCLUDED.RSQ7, 
    EXCLUDED.RSQ8, EXCLUDED. RSQ9, EXCLUDED.RSQ10, EXCLUDED.RSQ11, EXCLUDED.RSQ12, EXCLUDED.RSQ13, EXCLUDED.RSQ14, 
    EXCLUDED.RSQ15, EXCLUDED.RSQ16, EXCLUDED.RSQ17, EXCLUDED.RSQ18, EXCLUDED.RSQ19, EXCLUDED.RSQ20, EXCLUDED.RSQ21, 
    EXCLUDED.RSQ22, EXCLUDED.RSQ23, EXCLUDED. RSQ24, EXCLUDED.RSQ25, EXCLUDED.RSQ26, EXCLUDED.RSQ27, EXCLUDED.RSQ28, 
    EXCLUDED.RSQ29, EXCLUDED.RSQ30, EXCLUDED.RSQ31, EXCLUDED.RSQ32, EXCLUDED.RSQ33, EXCLUDED.RSQ34, EXCLUDED.RSQ35, 
    EXCLUDED.RSQ36, EXCLUDED.RSQ37, EXCLUDED.RSQ38, EXCLUDED. RSQ39, EXCLUDED.RSQ40, EXCLUDED.RSQ41, EXCLUDED.RSQ42, 
    EXCLUDED.RSQ43, EXCLUDED.RSQ44, EXCLUDED.RSQ45, EXCLUDED.RSQ46, EXCLUDED.RSQ47, EXCLUDED.RSQ48, EXCLUDED.RSQ49, 
    EXCLUDED.RSQ50, EXCLUDED.RSQ51, EXCLUDED.RSQ52, EXCLUDED.RSQ53, EXCLUDED. RSQ54, EXCLUDED.RSQ55, EXCLUDED.RSQ56, 
    EXCLUDED.RSQ57, EXCLUDED.RSQ58, EXCLUDED.RSQ59, EXCLUDED.RSQ60, EXCLUDED.RSQ61, EXCLUDED.RSQ62, EXCLUDED.RSQ63, 
    EXCLUDED.RSQ64, EXCLUDED.RSQ65, EXCLUDED.RSQ66, EXCLUDED.RSQ67, EXCLUDED.RSQ68, EXCLUDED. RSQ69, EXCLUDED.RSQ70, 
    EXCLUDED.RSQ71, EXCLUDED.RSQ72, EXCLUDED.RSQ73, EXCLUDED.RSQ74, EXCLUDED.RSQ75, EXCLUDED.RSQ76, EXCLUDED.RSQ77, 
    EXCLUDED.RSQ78, EXCLUDED.RSQ79, EXCLUDED.RSQ80, EXCLUDED.RSQ81, EXCLUDED.RSQ82, EXCLUDED.RSQ83, EXCLUDED. RSQ84, 
    EXCLUDED.RSQ85, EXCLUDED.RSQ86, EXCLUDED.RSQ87, EXCLUDED.RSQ88, EXCLUDED.RSQ89, EXCLUDED.RSQ90, EXCLUDED.RSQ91, 
    EXCLUDED.RSQ92, EXCLUDED.RSQ93, EXCLUDED.RSQ94, EXCLUDED.RSQ95, EXCLUDED.RSQ96, EXCLUDED.RSQ97, EXCLUDED.RSQ98, 
    EXCLUDED. RSQ99, EXCLUDED.RSQ100, EXCLUDED.RSQ101, EXCLUDED.RSQ102, EXCLUDED.RSQ103, EXCLUDED.RSQ104, 
    EXCLUDED.RSQ105, EXCLUDED.RSQ106, EXCLUDED.RSQ107, EXCLUDED.RSQ108, EXCLUDED.RSQ109, EXCLUDED.RSQ110, 
    EXCLUDED.RSQ111, EXCLUDED. RSQ112, EXCLUDED.RSQ113, EXCLUDED.RSQ114, EXCLUDED.RSQ115, EXCLUDED.RSQ116, 
    EXCLUDED.RSQ117, EXCLUDED.RSQ118, EXCLUDED.RSQ119, EXCLUDED.RSQ120, EXCLUDED.RSQ121, EXCLUDED.RSQ122, 
    EXCLUDED.RSQ123, EXCLUDED.RSQ124, EXCLUDED. RSQ125, EXCLUDED.RSQ126, EXCLUDED.RSQ127, EXCLUDED.RSQ128, 
    EXCLUDED.RSQ129, EXCLUDED.RSQ130, EXCLUDED.RSQ131, EXCLUDED.RSQ132, EXCLUDED.RSQ133, EXCLUDED.RSQ134, 
    EXCLUDED.RSQ135, EXCLUDED.RSQ136, EXCLUDED.RSQ137, EXCLUDED. RSQ138, EXCLUDED.RSQ139, EXCLUDED.RSQ140, 
    EXCLUDED.RSQ141, EXCLUDED.RSQ142, EXCLUDED.RSQ143, EXCLUDED.RSQ144, EXCLUDED.RSQ145, EXCLUDED.RSQ146, 
    EXCLUDED.RSQ147, EXCLUDED.RSQ148, EXCLUDED.RSD50, EXCLUDED.RSD51, EXCLUDED.RSD52, EXCLUDED. RSD53, 
    EXCLUDED.RSD54, EXCLUDED.RSD55)''',
                          [[item.get("RatioIcbIndustryId"), item.get("IcbCode"), item.get("ComGroupCode"),
                            item.get("TradingDate"),
                            item.get("Status"),
                            item.get("CreateDate"), item.get("UpdateDate"),
                            item.get("RSD1"), item.get("RSD2"), item.get("RSD3"), item.get("RSD4"), item.get("RSD5"),
                            item.get("RSD6"), item.get("RSD7"),
                            item.get("RSD8"), item.get("RSD9"),
                            item.get("RSD10"), item.get("RSD11"), item.get("RSD12"), item.get("RSD13"),
                            item.get("RSD14"),
                            item.get("RSD15"),
                            item.get("RSD16"), item.get("RSD17"), item.get("RSD18"),
                            item.get("RSD19"), item.get("RSD20"), item.get("RSD21"), item.get("RSD22"),
                            item.get("RSD23"),
                            item.get("RSD24"),
                            item.get("RSD25"), item.get("RSD26"), item.get("RSD27"),
                            item.get("RSD28"), item.get("RSD29"), item.get("RSD30"), item.get("RSD31"),
                            item.get("RSD32"),
                            item.get("RSD33"),
                            item.get("RSD34"), item.get("RSD35"), item.get("RSD36"),
                            item.get("RSD37"), item.get("RSD38"), item.get("RSD39"), item.get("RSD40"),
                            item.get("RSD41"),
                            item.get("RSD42"),
                            item.get("RSD43"), item.get("RSD44"), item.get("RSD45"),
                            item.get("RSD46"), item.get("RSD47"), item.get("RSD48"), item.get("RSD49"),
                            item.get("RSQ1"), item.get("RSQ2"), item.get("RSQ3"), item.get("RSQ4"), item.get("RSQ5"),
                            item.get("RSQ6"), item.get("RSQ7"),
                            item.get("RSQ8"), item.get("RSQ9"),
                            item.get("RSQ10"), item.get("RSQ11"), item.get("RSQ12"), item.get("RSQ13"),
                            item.get("RSQ14"),
                            item.get("RSQ15"),
                            item.get("RSQ16"), item.get("RSQ17"), item.get("RSQ18"),
                            item.get("RSQ19"), item.get("RSQ20"), item.get("RSQ21"), item.get("RSQ22"),
                            item.get("RSQ23"),
                            item.get("RSQ24"),
                            item.get("RSQ25"), item.get("RSQ26"), item.get("RSQ27"),
                            item.get("RSQ28"), item.get("RSQ29"), item.get("RSQ30"), item.get("RSQ31"),
                            item.get("RSQ32"),
                            item.get("RSQ33"),
                            item.get("RSQ34"), item.get("RSQ35"), item.get("RSQ36"),
                            item.get("RSQ37"), item.get("RSQ38"), item.get("RSQ39"), item.get("RSQ40"),
                            item.get("RSQ41"),
                            item.get("RSQ42"),
                            item.get("RSQ43"), item.get("RSQ44"), item.get("RSQ45"),
                            item.get("RSQ46"), item.get("RSQ47"), item.get("RSQ48"), item.get("RSQ49"),
                            item.get("RSQ50"),
                            item.get("RSQ51"),
                            item.get("RSQ52"), item.get("RSQ53"), item.get("RSQ54"),
                            item.get("RSQ55"), item.get("RSQ56"), item.get("RSQ57"), item.get("RSQ58"),
                            item.get("RSQ59"),
                            item.get("RSQ60"),
                            item.get("RSQ61"), item.get("RSQ62"), item.get("RSQ63"),
                            item.get("RSQ64"), item.get("RSQ65"), item.get("RSQ66"), item.get("RSQ67"),
                            item.get("RSQ68"),
                            item.get("RSQ69"),
                            item.get("RSQ70"), item.get("RSQ71"), item.get("RSQ72"),
                            item.get("RSQ73"), item.get("RSQ74"), item.get("RSQ75"), item.get("RSQ76"),
                            item.get("RSQ77"),
                            item.get("RSQ78"),
                            item.get("RSQ79"), item.get("RSQ80"), item.get("RSQ81"),
                            item.get("RSQ82"), item.get("RSQ83"), item.get("RSQ84"), item.get("RSQ85"),
                            item.get("RSQ86"),
                            item.get("RSQ87"),
                            item.get("RSQ88"), item.get("RSQ89"), item.get("RSQ90"),
                            item.get("RSQ91"), item.get("RSQ92"), item.get("RSQ93"), item.get("RSQ94"),
                            item.get("RSQ95"),
                            item.get("RSQ96"),
                            item.get("RSQ97"), item.get("RSQ98"), item.get("RSQ99"),
                            item.get("RSQ100"), item.get("RSQ101"), item.get("RSQ102"), item.get("RSQ103"),
                            item.get("RSQ104"),
                            item.get("RSQ105"),
                            item.get("RSQ106"), item.get("RSQ107"), item.get("RSQ108"),
                            item.get("RSQ109"), item.get("RSQ110"), item.get("RSQ111"), item.get("RSQ112"),
                            item.get("RSQ113"),
                            item.get("RSQ114"),
                            item.get("RSQ115"), item.get("RSQ116"), item.get("RSQ117"),
                            item.get("RSQ118"), item.get("RSQ119"), item.get("RSQ120"), item.get("RSQ121"),
                            item.get("RSQ122"),
                            item.get("RSQ123"),
                            item.get("RSQ124"), item.get("RSQ125"), item.get("RSQ126"),
                            item.get("RSQ127"), item.get("RSQ128"), item.get("RSQ129"), item.get("RSQ130"),
                            item.get("RSQ131"),
                            item.get("RSQ132"),
                            item.get("RSQ133"), item.get("RSQ134"), item.get("RSQ135"),
                            item.get("RSQ136"), item.get("RSQ137"), item.get("RSQ138"), item.get("RSQ139"),
                            item.get("RSQ140"),
                            item.get("RSQ141"),
                            item.get("RSQ142"), item.get("RSQ143"), item.get("RSQ144"),
                            item.get("RSQ145"), item.get("RSQ146"), item.get("RSQ147"), item.get("RSQ148"),
                            item.get("RSD50"),
                            item.get("RSD51"),
                            item.get("RSD52"), item.get("RSD53"), item.get("RSD54"), item.get("RSD55")] for item in
                           data])
    print("Done insert data table stx_rto_ratioicbindustry / Ratio", datetime.now().strftime('%Y-%m-%d %H:%M:%S'))
    telegram.send(mess=f"Done insert data table stx_rto_ratioicbindustry / Ratio / Data size: {len(data)}")


def get_ratio_index(date_request):
    # Init parameter
    if not date_request:  # Nếu không truyền ngày thì mặc định lấy ngày hiện tại
        date_request = datetime.now().strftime("%Y-%m-%d")
    page_index = 1
    page_size = 100
    url = BASE_URL + "/Ratio/GetRatioIndex?pageIndex=" + str(page_index) \
          + "&pageSize=" + str(page_size) \
          + "&DateType=" + DATE_TYPE + "&fromDate=" + date_request + "&toDate=" + date_request
    print("[get_ratio_index] get date >> ", url)
    response = service.make_request(url)
    if response is None:
        return

    data = response["Data"]
    paging = response["Paging"]

    while paging.get("NextPage") is not None:
        time.sleep(10)
        print("[get_ratio_index] NextPage : %s in TotalPage : %s", paging.get("NextPage"), paging.get("TotalPage"))
        url = BASE_URL + "/Ratio/GetRatioIndex?pageIndex=" + str(paging.get("NextPage")) \
              + "&pageSize=" + str(page_size) \
              + "&DateType=" + DATE_TYPE + "&fromDate=" + date_request + "&toDate=" + date_request
        print("[get_ratio_index] Next page found >> ", url)
        response = service.make_request(url)
        data = data + response["Data"]
        paging = response["Paging"]

        print("[get_ratio_index] Data size: ", len(data))

    database.execute_many('''INSERT INTO fiin_dtf.stx_rto_ratioindex (RatioIndexId, ComGroupCode, TradingDate, Status, 
    CreateDate, UpdateDate, RID1, RID2, RID3, RID4, RID5, RID6, RID7, RID8, RID9, RID10, RID11, RID12, RID13, 
    RID14, RID15, RID16, RID17, RID18, RID19, RID20, RID21, RID22, RID23, RID24, RID25, RID26, RID27, RID28, 
    RID29, RID30, RID31, RID32, RID33, RID34, RID35, RID36, RID37, RID38, RID39, RID40, RID41, RID42, RID43, 
    RID44, RID45, RID46, RID47, RID48, RID49, RIQ1, RIQ2, RIQ3, RIQ4, RIQ5, RIQ6, RIQ7, RIQ8, RIQ9, RIQ10, RIQ11, 
    RIQ12, RIQ13, RIQ14, RIQ15, RIQ16, RIQ17, RIQ18, RIQ19, RIQ20, RIQ21, RIQ22, RIQ23, RIQ24, RIQ25, RIQ26, 
    RIQ27, RIQ28, RIQ29, RIQ30, RIQ31, RIQ32, RIQ33, RIQ34, RIQ35, RIQ36, RIQ37, RIQ38, RIQ39, RIQ40, RIQ41, 
    RIQ42, RIQ43, RIQ44, RIQ45, RIQ46, RIQ47, RIQ48, RIQ49, RIQ50, RIQ51, RIQ52, RIQ53, RIQ54, RIQ55, RIQ56, 
    RIQ57, RIQ58, RIQ59, RIQ60, RIQ61, RIQ62, RIQ63, RIQ64, RIQ65, RIQ66, RIQ67, RIQ68, RIQ69, RIQ70, RIQ71, 
    RIQ72, RIQ73, RIQ74, RIQ75, RIQ76, RIQ77, RIQ78, RIQ79, RIQ80, RIQ81, RIQ82, RIQ83, RIQ84, RIQ85, RIQ86, 
    RIQ87, RIQ88, RIQ89, RIQ90, RIQ91, RIQ92, RIQ93, RIQ94, RIQ95, RIQ96, RIQ97, RIQ98, RIQ99, RIQ100, RIQ101, 
    RIQ102, RIQ103, RIQ104, RIQ105, RIQ106, RIQ107, RIQ108, RIQ109, RIQ110, RIQ111, RIQ112, RIQ113, RIQ114, 
    RIQ115, RIQ116, RIQ117, RIQ118, RIQ119, RIQ120, RIQ121, RIQ122, RIQ123, RIQ124, RIQ125, RIQ126, RIQ127, 
    RIQ128, RIQ129, RIQ130, RIQ131, RIQ132, RIQ133, RIQ134, RIQ135, RIQ136, RIQ137, RIQ138, RIQ139, RIQ140, 
    RIQ141, RIQ142, RIQ143, RIQ144, RIQ145, RIQ146, RIQ147, RIQ148, RID50, RID51, RID52, RID53, RID54, 
    RID55) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s) ON CONFLICT 
    ON CONSTRAINT xpkstx_fsc_ratioindex DO UPDATE SET (RatioIndexId, ComGroupCode, TradingDate, Status, 
    CreateDate, UpdateDate, RID1, RID2, RID3, RID4, RID5, RID6, RID7, RID8, RID9, RID10, RID11, RID12, RID13, 
    RID14, RID15, RID16, RID17, RID18, RID19, RID20, RID21, RID22, RID23, RID24, RID25, RID26, RID27, RID28, 
    RID29, RID30, RID31, RID32, RID33, RID34, RID35, RID36, RID37, RID38, RID39, RID40, RID41, RID42, RID43, 
    RID44, RID45, RID46, RID47, RID48, RID49, RIQ1, RIQ2, RIQ3, RIQ4, RIQ5, RIQ6, RIQ7, RIQ8, RIQ9, RIQ10, RIQ11, 
    RIQ12, RIQ13, RIQ14, RIQ15, RIQ16, RIQ17, RIQ18, RIQ19, RIQ20, RIQ21, RIQ22, RIQ23, RIQ24, RIQ25, RIQ26, 
    RIQ27, RIQ28, RIQ29, RIQ30, RIQ31, RIQ32, RIQ33, RIQ34, RIQ35, RIQ36, RIQ37, RIQ38, RIQ39, RIQ40, RIQ41, 
    RIQ42, RIQ43, RIQ44, RIQ45, RIQ46, RIQ47, RIQ48, RIQ49, RIQ50, RIQ51, RIQ52, RIQ53, RIQ54, RIQ55, RIQ56, 
    RIQ57, RIQ58, RIQ59, RIQ60, RIQ61, RIQ62, RIQ63, RIQ64, RIQ65, RIQ66, RIQ67, RIQ68, RIQ69, RIQ70, RIQ71, 
    RIQ72, RIQ73, RIQ74, RIQ75, RIQ76, RIQ77, RIQ78, RIQ79, RIQ80, RIQ81, RIQ82, RIQ83, RIQ84, RIQ85, RIQ86, 
    RIQ87, RIQ88, RIQ89, RIQ90, RIQ91, RIQ92, RIQ93, RIQ94, RIQ95, RIQ96, RIQ97, RIQ98, RIQ99, RIQ100, RIQ101, 
    RIQ102, RIQ103, RIQ104, RIQ105, RIQ106, RIQ107, RIQ108, RIQ109, RIQ110, RIQ111, RIQ112, RIQ113, RIQ114, 
    RIQ115, RIQ116, RIQ117, RIQ118, RIQ119, RIQ120, RIQ121, RIQ122, RIQ123, RIQ124, RIQ125, RIQ126, RIQ127, 
    RIQ128, RIQ129, RIQ130, RIQ131, RIQ132, RIQ133, RIQ134, RIQ135, RIQ136, RIQ137, RIQ138, RIQ139, RIQ140, 
    RIQ141, RIQ142, RIQ143, RIQ144, RIQ145, RIQ146, RIQ147, RIQ148, RID50, RID51, RID52, RID53, RID54, 
    RID55) = (EXCLUDED.RatioIndexId, EXCLUDED.ComGroupCode, EXCLUDED.TradingDate, EXCLUDED. Status, 
    EXCLUDED.CreateDate, EXCLUDED.UpdateDate, EXCLUDED.RID1, EXCLUDED.RID2, EXCLUDED.RID3, EXCLUDED.RID4, 
    EXCLUDED.RID5, EXCLUDED.RID6, EXCLUDED.RID7, EXCLUDED.RID8, EXCLUDED.RID9, EXCLUDED.RID10, EXCLUDED.RID11, 
    EXCLUDED.RID12, EXCLUDED. RID13, EXCLUDED.RID14, EXCLUDED.RID15, EXCLUDED.RID16, EXCLUDED.RID17, 
    EXCLUDED.RID18, EXCLUDED.RID19, EXCLUDED.RID20, EXCLUDED.RID21, EXCLUDED.RID22, EXCLUDED.RID23, 
    EXCLUDED.RID24, EXCLUDED.RID25, EXCLUDED.RID26, EXCLUDED.RID27, EXCLUDED. RID28, EXCLUDED.RID29, 
    EXCLUDED.RID30, EXCLUDED.RID31, EXCLUDED.RID32, EXCLUDED.RID33, EXCLUDED.RID34, EXCLUDED.RID35, 
    EXCLUDED.RID36, EXCLUDED.RID37, EXCLUDED.RID38, EXCLUDED.RID39, EXCLUDED.RID40, EXCLUDED.RID41, 
    EXCLUDED.RID42, EXCLUDED.RID43, EXCLUDED.RID44, EXCLUDED.RID45, EXCLUDED.RID46, EXCLUDED.RID47, 
    EXCLUDED.RID48, EXCLUDED.RID49, EXCLUDED.RIQ1, EXCLUDED.RIQ2, EXCLUDED.RIQ3, EXCLUDED.RIQ4, EXCLUDED.RIQ5, 
    EXCLUDED.RIQ6, EXCLUDED.RIQ7, EXCLUDED.RIQ8, EXCLUDED.RIQ9, EXCLUDED.RIQ10, EXCLUDED. RIQ11, EXCLUDED.RIQ12, 
    EXCLUDED.RIQ13, EXCLUDED.RIQ14, EXCLUDED.RIQ15, EXCLUDED.RIQ16, EXCLUDED.RIQ17, EXCLUDED.RIQ18, 
    EXCLUDED.RIQ19, EXCLUDED.RIQ20, EXCLUDED.RIQ21, EXCLUDED.RIQ22, EXCLUDED.RIQ23, EXCLUDED.RIQ24, 
    EXCLUDED.RIQ25, EXCLUDED. RIQ26, EXCLUDED.RIQ27, EXCLUDED.RIQ28, EXCLUDED.RIQ29, EXCLUDED.RIQ30, 
    EXCLUDED.RIQ31, EXCLUDED.RIQ32, EXCLUDED.RIQ33, EXCLUDED.RIQ34, EXCLUDED.RIQ35, EXCLUDED.RIQ36, 
    EXCLUDED.RIQ37, EXCLUDED.RIQ38, EXCLUDED.RIQ39, EXCLUDED.RIQ40, EXCLUDED. RIQ41, EXCLUDED.RIQ42, 
    EXCLUDED.RIQ43, EXCLUDED.RIQ44, EXCLUDED.RIQ45, EXCLUDED.RIQ46, EXCLUDED.RIQ47, EXCLUDED.RIQ48, 
    EXCLUDED.RIQ49, EXCLUDED.RIQ50, EXCLUDED.RIQ51, EXCLUDED.RIQ52, EXCLUDED.RIQ53, EXCLUDED.RIQ54, 
    EXCLUDED.RIQ55, EXCLUDED. RIQ56, EXCLUDED.RIQ57, EXCLUDED.RIQ58, EXCLUDED.RIQ59, EXCLUDED.RIQ60, 
    EXCLUDED.RIQ61, EXCLUDED.RIQ62, EXCLUDED.RIQ63, EXCLUDED.RIQ64, EXCLUDED.RIQ65, EXCLUDED.RIQ66, 
    EXCLUDED.RIQ67, EXCLUDED.RIQ68, EXCLUDED.RIQ69, EXCLUDED.RIQ70, EXCLUDED. RIQ71, EXCLUDED.RIQ72, 
    EXCLUDED.RIQ73, EXCLUDED.RIQ74, EXCLUDED.RIQ75, EXCLUDED.RIQ76, EXCLUDED.RIQ77, EXCLUDED.RIQ78, 
    EXCLUDED.RIQ79, EXCLUDED.RIQ80, EXCLUDED.RIQ81, EXCLUDED.RIQ82, EXCLUDED.RIQ83, EXCLUDED.RIQ84, 
    EXCLUDED.RIQ85, EXCLUDED. RIQ86, EXCLUDED.RIQ87, EXCLUDED.RIQ88, EXCLUDED.RIQ89, EXCLUDED.RIQ90, 
    EXCLUDED.RIQ91, EXCLUDED.RIQ92, EXCLUDED.RIQ93, EXCLUDED.RIQ94, EXCLUDED.RIQ95, EXCLUDED.RIQ96, 
    EXCLUDED.RIQ97, EXCLUDED.RIQ98, EXCLUDED.RIQ99, EXCLUDED.RIQ100, EXCLUDED. RIQ101, EXCLUDED.RIQ102, 
    EXCLUDED.RIQ103, EXCLUDED.RIQ104, EXCLUDED.RIQ105, EXCLUDED.RIQ106, EXCLUDED.RIQ107, EXCLUDED.RIQ108, 
    EXCLUDED.RIQ109, EXCLUDED.RIQ110, EXCLUDED.RIQ111, EXCLUDED.RIQ112, EXCLUDED.RIQ113, EXCLUDED. RIQ114, 
    EXCLUDED.RIQ115, EXCLUDED.RIQ116, EXCLUDED.RIQ117, EXCLUDED.RIQ118, EXCLUDED.RIQ119, EXCLUDED.RIQ120, 
    EXCLUDED.RIQ121, EXCLUDED.RIQ122, EXCLUDED.RIQ123, EXCLUDED.RIQ124, EXCLUDED.RIQ125, EXCLUDED.RIQ126, 
    EXCLUDED. RIQ127, EXCLUDED.RIQ128, EXCLUDED.RIQ129, EXCLUDED.RIQ130, EXCLUDED.RIQ131, EXCLUDED.RIQ132, 
    EXCLUDED.RIQ133, EXCLUDED.RIQ134, EXCLUDED.RIQ135, EXCLUDED.RIQ136, EXCLUDED.RIQ137, EXCLUDED.RIQ138, 
    EXCLUDED.RIQ139, EXCLUDED. RIQ140, EXCLUDED.RIQ141, EXCLUDED.RIQ142, EXCLUDED.RIQ143, EXCLUDED.RIQ144, 
    EXCLUDED.RIQ145, EXCLUDED.RIQ146, EXCLUDED.RIQ147, EXCLUDED.RIQ148, EXCLUDED.RID50, EXCLUDED.RID51, 
    EXCLUDED.RID52, EXCLUDED.RID53, EXCLUDED.RID54, EXCLUDED. RID55)''',
                          [[item.get("RatioIndexId"), item.get("ComGroupCode"), item.get("TradingDate"),
                            item.get("Status"),
                            item.get("CreateDate"),
                            item.get("UpdateDate"),
                            item.get("RID1"), item.get("RID2"), item.get("RID3"), item.get("RID4"), item.get("RID5"),
                            item.get("RID6"), item.get("RID7"),
                            item.get("RID8"), item.get("RID9"),
                            item.get("RID10"), item.get("RID11"), item.get("RID12"), item.get("RID13"),
                            item.get("RID14"),
                            item.get("RID15"),
                            item.get("RID16"), item.get("RID17"), item.get("RID18"),
                            item.get("RID19"), item.get("RID20"), item.get("RID21"), item.get("RID22"),
                            item.get("RID23"),
                            item.get("RID24"),
                            item.get("RID25"), item.get("RID26"), item.get("RID27"),
                            item.get("RID28"), item.get("RID29"), item.get("RID30"), item.get("RID31"),
                            item.get("RID32"),
                            item.get("RID33"),
                            item.get("RID34"), item.get("RID35"), item.get("RID36"),
                            item.get("RID37"), item.get("RID38"), item.get("RID39"), item.get("RID40"),
                            item.get("RID41"),
                            item.get("RID42"),
                            item.get("RID43"), item.get("RID44"), item.get("RID45"),
                            item.get("RID46"), item.get("RID47"), item.get("RID48"), item.get("RID49"),
                            item.get("RIQ1"), item.get("RIQ2"), item.get("RIQ3"), item.get("RIQ4"), item.get("RIQ5"),
                            item.get("RIQ6"), item.get("RIQ7"),
                            item.get("RIQ8"), item.get("RIQ9"),
                            item.get("RIQ10"), item.get("RIQ11"), item.get("RIQ12"), item.get("RIQ13"),
                            item.get("RIQ14"),
                            item.get("RIQ15"),
                            item.get("RIQ16"), item.get("RIQ17"), item.get("RIQ18"),
                            item.get("RIQ19"), item.get("RIQ20"), item.get("RIQ21"), item.get("RIQ22"),
                            item.get("RIQ23"),
                            item.get("RIQ24"),
                            item.get("RIQ25"), item.get("RIQ26"), item.get("RIQ27"),
                            item.get("RIQ28"), item.get("RIQ29"), item.get("RIQ30"), item.get("RIQ31"),
                            item.get("RIQ32"),
                            item.get("RIQ33"),
                            item.get("RIQ34"), item.get("RIQ35"), item.get("RIQ36"),
                            item.get("RIQ37"), item.get("RIQ38"), item.get("RIQ39"), item.get("RIQ40"),
                            item.get("RIQ41"),
                            item.get("RIQ42"),
                            item.get("RIQ43"), item.get("RIQ44"), item.get("RIQ45"),
                            item.get("RIQ46"), item.get("RIQ47"), item.get("RIQ48"), item.get("RIQ49"),
                            item.get("RIQ50"),
                            item.get("RIQ51"),
                            item.get("RIQ52"), item.get("RIQ53"), item.get("RIQ54"),
                            item.get("RIQ55"), item.get("RIQ56"), item.get("RIQ57"), item.get("RIQ58"),
                            item.get("RIQ59"),
                            item.get("RIQ60"),
                            item.get("RIQ61"), item.get("RIQ62"), item.get("RIQ63"),
                            item.get("RIQ64"), item.get("RIQ65"), item.get("RIQ66"), item.get("RIQ67"),
                            item.get("RIQ68"),
                            item.get("RIQ69"),
                            item.get("RIQ70"), item.get("RIQ71"), item.get("RIQ72"),
                            item.get("RIQ73"), item.get("RIQ74"), item.get("RIQ75"), item.get("RIQ76"),
                            item.get("RIQ77"),
                            item.get("RIQ78"),
                            item.get("RIQ79"), item.get("RIQ80"), item.get("RIQ81"),
                            item.get("RIQ82"), item.get("RIQ83"), item.get("RIQ84"), item.get("RIQ85"),
                            item.get("RIQ86"),
                            item.get("RIQ87"),
                            item.get("RIQ88"), item.get("RIQ89"), item.get("RIQ90"),
                            item.get("RIQ91"), item.get("RIQ92"), item.get("RIQ93"), item.get("RIQ94"),
                            item.get("RIQ95"),
                            item.get("RIQ96"),
                            item.get("RIQ97"), item.get("RIQ98"), item.get("RIQ99"),
                            item.get("RIQ100"), item.get("RIQ101"), item.get("RIQ102"), item.get("RIQ103"),
                            item.get("RIQ104"),
                            item.get("RIQ105"),
                            item.get("RIQ106"), item.get("RIQ107"), item.get("RIQ108"),
                            item.get("RIQ109"), item.get("RIQ110"), item.get("RIQ111"), item.get("RIQ112"),
                            item.get("RIQ113"),
                            item.get("RIQ114"),
                            item.get("RIQ115"), item.get("RIQ116"), item.get("RIQ117"),
                            item.get("RIQ118"), item.get("RIQ119"), item.get("RIQ120"), item.get("RIQ121"),
                            item.get("RIQ122"),
                            item.get("RIQ123"),
                            item.get("RIQ124"), item.get("RIQ125"), item.get("RIQ126"),
                            item.get("RIQ127"), item.get("RIQ128"), item.get("RIQ129"), item.get("RIQ130"),
                            item.get("RIQ131"),
                            item.get("RIQ132"),
                            item.get("RIQ133"), item.get("RIQ134"), item.get("RIQ135"),
                            item.get("RIQ136"), item.get("RIQ137"), item.get("RIQ138"), item.get("RIQ139"),
                            item.get("RIQ140"),
                            item.get("RIQ141"),
                            item.get("RIQ142"), item.get("RIQ143"), item.get("RIQ144"),
                            item.get("RIQ145"), item.get("RIQ146"), item.get("RIQ147"), item.get("RIQ148"),
                            item.get("RIQ50"),
                            item.get("RIQ51"),
                            item.get("RIQ52"), item.get("RIQ53"), item.get("RIQ54"), item.get("RIQ55")] for item in
                           data])
    print("Done insert data table stx_rto_ratioindex / Ratio", datetime.now().strftime('%Y-%m-%d %H:%M:%S'))
    telegram.send(mess=f"Done insert data table stx_rto_ratioindex / Ratio / Data size: {len(data)}")


def get_ratio_TTM(date_request):
    # Init parameter
    if not date_request:  # Nếu không truyền ngày thì mặc định lấy ngày hiện tại
        date_request = datetime.now().strftime("%Y-%m-%d")
    page_index = 1
    page_size = 100
    url = BASE_URL + "/Ratio/GetRatioTTM?pageIndex=" + str(page_index) \
          + "&pageSize=" + str(page_size) \
          + "&DateType=" + DATE_TYPE + "&fromDate=" + date_request + "&toDate=" + date_request
    print("[get_ratio_TTM] get date >> ", url)
    response = service.make_request(url)
    if response is None:
        return

    data = response["Data"]
    paging = response["Paging"]

    while paging.get("NextPage") is not None:
        time.sleep(10)
        print("[get_ratio_TTM] NextPage : %s in TotalPage : %s", paging.get("NextPage"), paging.get("TotalPage"))
        url = BASE_URL + "/Ratio/GetRatioTTM?pageIndex=" + str(paging.get("NextPage")) \
              + "&pageSize=" + str(page_size) \
              + "&DateType=" + DATE_TYPE + "&fromDate=" + date_request + "&toDate=" + date_request
        print("[get_ratio_TTM] Next page found >> ", url)
        response = service.make_request(url)
        data = data + response["Data"]
        paging = response["Paging"]

        print("[get_ratio_TTM] Data size: ", len(data))

    database.execute_many('''INSERT INTO fiin_dtf.stx_rto_ratiottm (RatioTTMId, OrganCode, ComTypeCode, Ticker, 
    YearReport, LengthReport, YearReportCal, LengthReportCal, IndexBasis, TradingDate, TTMType, Status, 
    CreateDate, UpdateDate, RTQ1, RTQ2, RTQ3, RTQ4, RTQ5, RTQ6, RTQ7, RTQ8, RTQ9, RTQ10, RTQ11, RTQ12, RTQ13, 
    RTQ14, RTQ15, RTQ16, RTQ17, RTQ18, RTQ19, RTQ20, RTQ21, RTQ22, RTQ23, RTQ24, RTQ25, RTQ26, RTQ27, RTQ28, 
    RTQ29, RTQ30, RTQ31, RTQ32, RTQ33, RTQ34, RTQ35, RTQ36, RTQ37, RTQ38, RTQ39, RTQ40, RTQ41, RTQ42, RTQ43, 
    RTQ44, RTQ45, RTQ46, RTQ47, RTQ48, RTQ49, RTQ50, RTQ51, RTQ52, RTQ53, RTQ54, RTQ55, RTQ56, RTQ57, RTQ58, 
    RTQ59, RTQ60, RTQ61, RTQ62, RTQ63, RTQ64, RTQ65, RTQ66, RTQ67, RTQ68, RTQ69, RTQ70, RTQ71, RTQ72, RTQ73, 
    RTQ74, RTQ75, RTQ76, RTQ77, RTQ78, RTQ79, RTQ80, RTQ81, RTQ82, RTQ83, RTQ84, RTQ85, RTQ86, RTQ87, RTQ88, 
    RTQ89, RTQ90, RTQ91, RTQ92, RTQ93, RTQ94, RTQ95, RTQ96, RTQ97, RTQ98, RTQ99, RTQ100, RTQ101, RTQ102, RTQ103, 
    RTQ104, RTQ105, RTQ106, RTQ107, RTQ108, RTQ109, RTQ110, RTQ111, RTQ112, RTQ113, RTQ114, RTQ115, RTQ116, 
    RTQ117, RTQ118, RTQ119, RTQ120, RTQ121, RTQ122, RTQ123, RTQ124, RTQ125, RTQ126, RTQ127, RTQ128, RTQ129, 
    RTQ130, RTQ131, RTQ132, RTQ133, RTQ134, RTQ135, RTQ136, RTQ137, RTQ138, RTQ139, RTQ140, RTQ141, RTQ142, 
    RTQ143, RTQ144, RTQ145, IntegratedDate, RTQ146, RTQ147, RTQ148, RTQ149, RTQ150, RTQ151, RTQ152, RTQ153, 
    RTQ154, RTQ155, RTQ156, RTQ157, RTQ158, RTQ159, RTQ160, RTQ161, RTQ162, RTQ163, RTQ164, RTQ165, RTQ166, 
    RTQ167, RTQ168, RTQ169, RTQ170, RTQ171, RTQ172, RTQ173, RTQ174, RTQ175, RTQ176, RTQ177, RTQ178, 
    RTQ179) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s) ON CONFLICT ON CONSTRAINT xpkstx_fsc_ratiottm1 DO UPDATE SET (RatioTTMId, 
    OrganCode, ComTypeCode, Ticker, YearReport, LengthReport, YearReportCal, LengthReportCal, IndexBasis, 
    TradingDate, TTMType, Status, CreateDate, UpdateDate, RTQ1, RTQ2, RTQ3, RTQ4, RTQ5, RTQ6, RTQ7, RTQ8, RTQ9, 
    RTQ10, RTQ11, RTQ12, RTQ13, RTQ14, RTQ15, RTQ16, RTQ17, RTQ18, RTQ19, RTQ20, RTQ21, RTQ22, RTQ23, RTQ24, 
    RTQ25, RTQ26, RTQ27, RTQ28, RTQ29, RTQ30, RTQ31, RTQ32, RTQ33, RTQ34, RTQ35, RTQ36, RTQ37, RTQ38, RTQ39, 
    RTQ40, RTQ41, RTQ42, RTQ43, RTQ44, RTQ45, RTQ46, RTQ47, RTQ48, RTQ49, RTQ50, RTQ51, RTQ52, RTQ53, RTQ54, 
    RTQ55, RTQ56, RTQ57, RTQ58, RTQ59, RTQ60, RTQ61, RTQ62, RTQ63, RTQ64, RTQ65, RTQ66, RTQ67, RTQ68, RTQ69, 
    RTQ70, RTQ71, RTQ72, RTQ73, RTQ74, RTQ75, RTQ76, RTQ77, RTQ78, RTQ79, RTQ80, RTQ81, RTQ82, RTQ83, RTQ84, 
    RTQ85, RTQ86, RTQ87, RTQ88, RTQ89, RTQ90, RTQ91, RTQ92, RTQ93, RTQ94, RTQ95, RTQ96, RTQ97, RTQ98, RTQ99, 
    RTQ100, RTQ101, RTQ102, RTQ103, RTQ104, RTQ105, RTQ106, RTQ107, RTQ108, RTQ109, RTQ110, RTQ111, RTQ112, 
    RTQ113, RTQ114, RTQ115, RTQ116, RTQ117, RTQ118, RTQ119, RTQ120, RTQ121, RTQ122, RTQ123, RTQ124, RTQ125, 
    RTQ126, RTQ127, RTQ128, RTQ129, RTQ130, RTQ131, RTQ132, RTQ133, RTQ134, RTQ135, RTQ136, RTQ137, RTQ138, 
    RTQ139, RTQ140, RTQ141, RTQ142, RTQ143, RTQ144, RTQ145, IntegratedDate, RTQ146, RTQ147, RTQ148, RTQ149, 
    RTQ150, RTQ151, RTQ152, RTQ153, RTQ154, RTQ155, RTQ156, RTQ157, RTQ158, RTQ159, RTQ160, RTQ161, RTQ162, 
    RTQ163, RTQ164, RTQ165, RTQ166, RTQ167, RTQ168, RTQ169, RTQ170, RTQ171, RTQ172, RTQ173, RTQ174, RTQ175, 
    RTQ176, RTQ177, RTQ178, RTQ179) = (EXCLUDED.RatioTTMId, EXCLUDED.OrganCode, EXCLUDED.ComTypeCode, 
    EXCLUDED.Ticker, EXCLUDED. YearReport, EXCLUDED.LengthReport, EXCLUDED.YearReportCal, 
    EXCLUDED.LengthReportCal, EXCLUDED.IndexBasis, EXCLUDED.TradingDate, EXCLUDED.TTMType, EXCLUDED.Status, 
    EXCLUDED. CreateDate, EXCLUDED.UpdateDate, EXCLUDED.RTQ1, EXCLUDED.RTQ2, EXCLUDED.RTQ3, EXCLUDED.RTQ4, 
    EXCLUDED.RTQ5, EXCLUDED.RTQ6, EXCLUDED.RTQ7, EXCLUDED.RTQ8, EXCLUDED.RTQ9, EXCLUDED.RTQ10, EXCLUDED.RTQ11, 
    EXCLUDED.RTQ12, EXCLUDED.RTQ13, EXCLUDED. RTQ14, EXCLUDED.RTQ15, EXCLUDED.RTQ16, EXCLUDED.RTQ17, 
    EXCLUDED.RTQ18, EXCLUDED.RTQ19, EXCLUDED.RTQ20, EXCLUDED.RTQ21, EXCLUDED.RTQ22, EXCLUDED.RTQ23, 
    EXCLUDED.RTQ24, EXCLUDED.RTQ25, EXCLUDED.RTQ26, EXCLUDED.RTQ27, EXCLUDED.RTQ28, EXCLUDED. RTQ29, 
    EXCLUDED.RTQ30, EXCLUDED.RTQ31, EXCLUDED.RTQ32, EXCLUDED.RTQ33, EXCLUDED.RTQ34, EXCLUDED.RTQ35, 
    EXCLUDED.RTQ36, EXCLUDED.RTQ37, EXCLUDED.RTQ38, EXCLUDED.RTQ39, EXCLUDED.RTQ40, EXCLUDED.RTQ41, 
    EXCLUDED.RTQ42, EXCLUDED.RTQ43, EXCLUDED. RTQ44, EXCLUDED.RTQ45, EXCLUDED.RTQ46, EXCLUDED.RTQ47, 
    EXCLUDED.RTQ48, EXCLUDED.RTQ49, EXCLUDED.RTQ50, EXCLUDED.RTQ51, EXCLUDED.RTQ52, EXCLUDED.RTQ53, 
    EXCLUDED.RTQ54, EXCLUDED.RTQ55, EXCLUDED.RTQ56, EXCLUDED.RTQ57, EXCLUDED.RTQ58, EXCLUDED. RTQ59, 
    EXCLUDED.RTQ60, EXCLUDED.RTQ61, EXCLUDED.RTQ62, EXCLUDED.RTQ63, EXCLUDED.RTQ64, EXCLUDED.RTQ65, 
    EXCLUDED.RTQ66, EXCLUDED.RTQ67, EXCLUDED.RTQ68, EXCLUDED.RTQ69, EXCLUDED.RTQ70, EXCLUDED.RTQ71, 
    EXCLUDED.RTQ72, EXCLUDED.RTQ73, EXCLUDED. RTQ74, EXCLUDED.RTQ75, EXCLUDED.RTQ76, EXCLUDED.RTQ77, 
    EXCLUDED.RTQ78, EXCLUDED.RTQ79, EXCLUDED.RTQ80, EXCLUDED.RTQ81, EXCLUDED.RTQ82, EXCLUDED.RTQ83, 
    EXCLUDED.RTQ84, EXCLUDED.RTQ85, EXCLUDED.RTQ86, EXCLUDED.RTQ87, EXCLUDED.RTQ88, EXCLUDED. RTQ89, 
    EXCLUDED.RTQ90, EXCLUDED.RTQ91, EXCLUDED.RTQ92, EXCLUDED.RTQ93, EXCLUDED.RTQ94, EXCLUDED.RTQ95, 
    EXCLUDED.RTQ96, EXCLUDED.RTQ97, EXCLUDED.RTQ98, EXCLUDED.RTQ99, EXCLUDED.RTQ100, EXCLUDED.RTQ101, 
    EXCLUDED.RTQ102, EXCLUDED.RTQ103, EXCLUDED. RTQ104, EXCLUDED.RTQ105, EXCLUDED.RTQ106, EXCLUDED.RTQ107, 
    EXCLUDED.RTQ108, EXCLUDED.RTQ109, EXCLUDED.RTQ110, EXCLUDED.RTQ111, EXCLUDED.RTQ112, EXCLUDED.RTQ113, 
    EXCLUDED.RTQ114, EXCLUDED.RTQ115, EXCLUDED.RTQ116, EXCLUDED. RTQ117, EXCLUDED.RTQ118, EXCLUDED.RTQ119, 
    EXCLUDED.RTQ120, EXCLUDED.RTQ121, EXCLUDED.RTQ122, EXCLUDED.RTQ123, EXCLUDED.RTQ124, EXCLUDED.RTQ125, 
    EXCLUDED.RTQ126, EXCLUDED.RTQ127, EXCLUDED.RTQ128, EXCLUDED.RTQ129, EXCLUDED. RTQ130, EXCLUDED.RTQ131, 
    EXCLUDED.RTQ132, EXCLUDED.RTQ133, EXCLUDED.RTQ134, EXCLUDED.RTQ135, EXCLUDED.RTQ136, EXCLUDED.RTQ137, 
    EXCLUDED.RTQ138, EXCLUDED.RTQ139, EXCLUDED.RTQ140, EXCLUDED.RTQ141, EXCLUDED.RTQ142, EXCLUDED. RTQ143, 
    EXCLUDED.RTQ144, EXCLUDED.RTQ145, EXCLUDED.IntegratedDate, EXCLUDED.RTQ146, EXCLUDED.RTQ147, EXCLUDED.RTQ148, 
    EXCLUDED.RTQ149, EXCLUDED.RTQ150, EXCLUDED.RTQ151, EXCLUDED.RTQ152, EXCLUDED.RTQ153, EXCLUDED. RTQ154, 
    EXCLUDED.RTQ155, EXCLUDED.RTQ156, EXCLUDED.RTQ157, EXCLUDED.RTQ158, EXCLUDED.RTQ159, EXCLUDED.RTQ160, 
    EXCLUDED.RTQ161, EXCLUDED.RTQ162, EXCLUDED.RTQ163, EXCLUDED.RTQ164, EXCLUDED.RTQ165, EXCLUDED.RTQ166, 
    EXCLUDED. RTQ167, EXCLUDED.RTQ168, EXCLUDED.RTQ169, EXCLUDED.RTQ170, EXCLUDED.RTQ171, EXCLUDED.RTQ172, 
    EXCLUDED.RTQ173, EXCLUDED.RTQ174, EXCLUDED.RTQ175, EXCLUDED.RTQ176, EXCLUDED.RTQ177, EXCLUDED.RTQ178, 
    EXCLUDED. RTQ179)''',
                          [[item.get("RatioTTMId"), item.get("OrganCode"), item.get("ComTypeCode"), item.get("Ticker"),
                            item.get("YearReport"),
                            item.get("LengthReport"), item.get("YearReportCal"), item.get("LengthReportCal"),
                            item.get("IndexBasis"), item.get("TradingDate"), item.get("TTMType"),
                            item.get("Status"), item.get("CreateDate"), item.get("UpdateDate"),
                            item.get("RTQ1"), item.get("RTQ2"), item.get("RTQ3"), item.get("RTQ4"), item.get("RTQ5"),
                            item.get("RTQ6"), item.get("RTQ7"),
                            item.get("RTQ8"), item.get("RTQ9"),
                            item.get("RTQ10"), item.get("RTQ11"), item.get("RTQ12"), item.get("RTQ13"),
                            item.get("RTQ14"),
                            item.get("RTQ15"),
                            item.get("RTQ16"), item.get("RTQ17"), item.get("RTQ18"),
                            item.get("RTQ19"), item.get("RTQ20"), item.get("RTQ21"), item.get("RTQ22"),
                            item.get("RTQ23"),
                            item.get("RTQ24"),
                            item.get("RTQ25"), item.get("RTQ26"), item.get("RTQ27"),
                            item.get("RTQ28"), item.get("RTQ29"), item.get("RTQ30"), item.get("RTQ31"),
                            item.get("RTQ32"),
                            item.get("RTQ33"),
                            item.get("RTQ34"), item.get("RTQ35"), item.get("RTQ36"),
                            item.get("RTQ37"), item.get("RTQ38"), item.get("RTQ39"), item.get("RTQ40"),
                            item.get("RTQ41"),
                            item.get("RTQ42"),
                            item.get("RTQ43"), item.get("RTQ44"), item.get("RTQ45"),
                            item.get("RTQ46"), item.get("RTQ47"), item.get("RTQ48"), item.get("RTQ49"),
                            item.get("RTQ50"),
                            item.get("RTQ51"),
                            item.get("RTQ52"), item.get("RTQ53"), item.get("RTQ54"),
                            item.get("RTQ55"), item.get("RTQ56"), item.get("RTQ57"), item.get("RTQ58"),
                            item.get("RTQ59"),
                            item.get("RTQ60"),
                            item.get("RTQ61"), item.get("RTQ62"), item.get("RTQ63"),
                            item.get("RTQ64"), item.get("RTQ65"), item.get("RTQ66"), item.get("RTQ67"),
                            item.get("RTQ68"),
                            item.get("RTQ69"),
                            item.get("RTQ70"), item.get("RTQ71"), item.get("RTQ72"),
                            item.get("RTQ73"), item.get("RTQ74"), item.get("RTQ75"), item.get("RTQ76"),
                            item.get("RTQ77"),
                            item.get("RTQ78"),
                            item.get("RTQ79"), item.get("RTQ80"), item.get("RTQ81"),
                            item.get("RTQ82"), item.get("RTQ83"), item.get("RTQ84"), item.get("RTQ85"),
                            item.get("RTQ86"),
                            item.get("RTQ87"),
                            item.get("RTQ88"), item.get("RTQ89"), item.get("RTQ90"),
                            item.get("RTQ91"), item.get("RTQ92"), item.get("RTQ93"), item.get("RTQ94"),
                            item.get("RTQ95"),
                            item.get("RTQ96"),
                            item.get("RTQ97"), item.get("RTQ98"), item.get("RTQ99"),
                            item.get("RTQ100"), item.get("RTQ101"), item.get("RTQ102"), item.get("RTQ103"),
                            item.get("RTQ104"),
                            item.get("RTQ105"),
                            item.get("RTQ106"), item.get("RTQ107"), item.get("RTQ108"),
                            item.get("RTQ109"), item.get("RTQ110"), item.get("RTQ111"), item.get("RTQ112"),
                            item.get("RTQ113"),
                            item.get("RTQ114"),
                            item.get("RTQ115"), item.get("RTQ116"), item.get("RTQ117"),
                            item.get("RTQ118"), item.get("RTQ119"), item.get("RTQ120"), item.get("RTQ121"),
                            item.get("RTQ122"),
                            item.get("RTQ123"),
                            item.get("RTQ124"), item.get("RTQ125"), item.get("RTQ126"),
                            item.get("RTQ127"), item.get("RTQ128"), item.get("RTQ129"), item.get("RTQ130"),
                            item.get("RTQ131"),
                            item.get("RTQ132"),
                            item.get("RTQ133"), item.get("RTQ134"), item.get("RTQ135"),
                            item.get("RTQ136"), item.get("RTQ137"), item.get("RTQ138"), item.get("RTQ139"),
                            item.get("RTQ140"),
                            item.get("RTQ141"),
                            item.get("RTQ142"), item.get("RTQ143"), item.get("RTQ144"),
                            item.get("RTQ145"), item.get("IntegratedDate"), item.get("RTQ146"), item.get("RTQ147"),
                            item.get("RTQ148"),
                            item.get("RTQ149"), item.get("RTQ150"),
                            item.get("RTQ151"), item.get("RTQ152"), item.get("RTQ153"),
                            item.get("RTQ154"), item.get("RTQ155"), item.get("RTQ156"), item.get("RTQ157"),
                            item.get("RTQ158"),
                            item.get("RTQ159"),
                            item.get("RTQ160"), item.get("RTQ161"), item.get("RTQ162"),
                            item.get("RTQ163"), item.get("RTQ164"), item.get("RTQ165"), item.get("RTQ166"),
                            item.get("RTQ167"),
                            item.get("RTQ168"),
                            item.get("RTQ169"), item.get("RTQ170"), item.get("RTQ171"),
                            item.get("RTQ172"), item.get("RTQ173"), item.get("RTQ174"), item.get("RTQ175"),
                            item.get("RTQ176"),
                            item.get("RTQ177"),
                            item.get("RTQ178"), item.get("RTQ179")] for item in data])
    print("Done insert data table stx_rto_ratiottm / Ratio", datetime.now().strftime('%Y-%m-%d %H:%M:%S'))
    telegram.send(mess=f"Done insert data table stx_rto_ratiottm / Ratio / Data size: {len(data)}")


def get_return_stock(date_request):
    # Init parameter
    if not date_request:  # Nếu không truyền ngày thì mặc định lấy ngày hiện tại
        date_request = datetime.now().strftime("%Y-%m-%d")
    page_index = 1
    page_size = 100
    url = BASE_URL + "/Ratio/GetReturnStock?pageIndex=" + str(page_index) \
          + "&pageSize=" + str(page_size) \
          + "&DateType=" + DATE_TYPE + "&fromDate=" + date_request + "&toDate=" + date_request
    print("[get_return_stock] get date >> ", url)
    response = service.make_request(url)
    if response is None:
        return

    data = response["Data"]
    paging = response["Paging"]

    while paging.get("NextPage") is not None:
        time.sleep(10)
        print("[get_return_stock] NextPage : %s in TotalPage : %s", paging.get("NextPage"), paging.get("TotalPage"))
        url = BASE_URL + "/Ratio/GetReturnStock?pageIndex=" + str(paging.get("NextPage")) \
              + "&pageSize=" + str(page_size) \
              + "&DateType=" + DATE_TYPE + "&fromDate=" + date_request + "&toDate=" + date_request
        print("[get_return_stock] Next page found >> ", url)
        response = service.make_request(url)
        data = data + response["Data"]
        paging = response["Paging"]

        print("[get_return_stock] Data size: ", len(data))

    database.execute_many('''INSERT INTO fiin_dtf.stx_rto_returnstock (ReturnStockId, OrganCode, ComGroupCode, Ticker, 
    TradingDate, Status, CreateDate, UpdateDate, HighestPrice1Week, HighestPrice2Week, HighestPrice1Month, 
    HighestPrice2Month, HighestPrice3Month, HighestPrice6Month, HighestPrice9Month, HighestPrice1Year, 
    HighestPriceYTD, HighestPrice52Week, LowestPrice1Week, LowestPrice2Week, LowestPrice1Month, 
    LowestPrice2Month, LowestPrice3Month, LowestPrice6Month, LowestPrice9Month, LowestPrice1Year, LowestPriceYTD, 
    LowestPrice52Week, PriceChange1Day, PriceChange1Week, PriceChange2Week, PriceChange1Month, PriceChange2Month, 
    PriceChange3Month, PriceChange6Month, PriceChange9Month, PriceChange1Year, PriceChangeYTD, PriceChange52Week, 
    PercentPriceChange1Day, PercentPriceChange1Week, PercentPriceChange2Week, PercentPriceChange1Month, 
    PercentPriceChange2Month, PercentPriceChange3Month, PercentPriceChange6Month, PercentPriceChange9Month, 
    PercentPriceChange1Year, PercentPriceChangeYTD, PercentPriceChange52Week, AverageVolume1Week, 
    AverageVolume2Week, AverageVolume1Month, AverageVolume2Month, AverageVolume3Month, AverageVolume6Month, 
    AverageVolume9Month, AverageVolume1Year, AverageVolumeYTD, AverageVolume52Week, HighestVolume1Week, 
    HighestVolume2Week, HighestVolume1Month, HighestVolume2Month, HighestVolume3Month, HighestVolume6Month, 
    HighestVolume9Month, HighestVolume1Year, HighestVolumeYTD, HighestVolume52Week, LowestVolume1Week, 
    LowestVolume2Week, LowestVolume1Month, LowestVolume2Month, LowestVolume3Month, LowestVolume6Month, 
    LowestVolume9Month, LowestVolume1Year, LowestVolumeYTD, LowestVolume52Week, AverageValue1Week, 
    AverageValue2Week, AverageValue1Month, AverageValue2Month, AverageValue3Month, AverageValue6Month, 
    AverageValue9Month, AverageValue1Year, AverageValueYTD, AverageValue52Week, HighestValue1Week, 
    HighestValue2Week, HighestValue1Month, HighestValue2Month, HighestValue3Month, HighestValue6Month, 
    HighestValue9Month, HighestValue1Year, HighestValueYTD, HighestValue52Week, LowestValue1Week, 
    LowestValue2Week, LowestValue1Month, LowestValue2Month, LowestValue3Month, LowestValue6Month, 
    LowestValue9Month, LowestValue1Year, LowestValueYTD, LowestValue52Week, AverageMatchVolume1Week, 
    AverageMatchVolume2Week, AverageMatchVolume1Month, AverageMatchVolume2Month, AverageMatchVolume3Month, 
    AverageMatchVolume6Month, AverageMatchVolume9Month, AverageMatchVolume1Year, AverageMatchVolumeYTD, 
    AverageMatchVolume52Week, AverageMatchValue1Week, AverageMatchValue2Week, AverageMatchValue1Month, 
    AverageMatchValue2Month, AverageMatchValue3Month, AverageMatchValue6Month, AverageMatchValue9Month, 
    AverageMatchValue1Year, AverageMatchValueYTD, AverageMatchValue52Week, PercentHighestPriceChange1Week, 
    PercentHighestPriceChange2Week, PercentHighestPriceChange1Month, PercentHighestPriceChange2Month, 
    PercentHighestPriceChange3Month, PercentHighestPriceChange6Month, PercentHighestPriceChange9Month, 
    PercentHighestPriceChange1Year, PercentHighestPriceChangeYTD, PercentHighestPriceChange52Week, 
    PercentLowestPriceChange1Week, PercentLowestPriceChange2Week, PercentLowestPriceChange1Month, 
    PercentLowestPriceChange2Month, PercentLowestPriceChange3Month, PercentLowestPriceChange6Month, 
    PercentLowestPriceChange9Month, PercentLowestPriceChange1Year, PercentLowestPriceChangeYTD, 
    PercentLowestPriceChange52Week, PercentPriceChangeFromHighest, PercentPriceChangeFromLowest, 
    PercentPriceChangeFTD, PercentMatchVolumeChange1Week, PercentMatchVolumeChange2Week, 
    PercentMatchVolumeChange1Month, PercentMatchVolumeChange2Month, PercentMatchVolumeChange3Month, 
    PercentMatchVolumeChange6Month, PercentMatchVolumeChange9Month, PercentMatchVolumeChange1Year, 
    PercentMatchVolumeChangeYTD, PercentMatchVolumeChange52Week, VWAP1Day, VWAP1Week, VWAP2Week, VWAP1Month, 
    VWAP2Month, VWAP3Month, VWAP6Month, VWAP9Month, VWAP1Year, VWAPYTD, VWAP52Week, 
    LocalIndividualBuyTradingMatchVolume, LocalIndividualBuyTradingMatchValue, 
    ForeignIndividualBuyTradingMatchVolume, ForeignIndividualBuyTradingMatchValue, 
    LocalInstitutionalBuyTradingMatchVolume, LocalInstitutionalBuyTradingMatchValue, 
    ForeignInstitutionalBuyTradingMatchVolume, ForeignInstitutionalBuyTradingMatchValue, 
    LocalIndividualSellTradingMatchVolume, LocalIndividualSellTradingMatchValue, 
    ForeignIndividualSellTradingMatchVolume, ForeignIndividualSellTradingMatchValue, 
    LocalInstitutionalSellTradingMatchVolume, LocalInstitutionalSellTradingMatchValue, 
    ForeignInstitutionalSellTradingMatchVolume, ForeignInstitutionalSellTradingMatchValue, 
    LocalIndividualBuyTradingDealVolume, LocalIndividualBuyTradingDealValue, 
    ForeignIndividualBuyTradingDealVolume, ForeignIndividualBuyTradingDealValue, 
    LocalInstitutionalBuyTradingDealVolume, LocalInstitutionalBuyTradingDealValue, 
    ForeignInstitutionalBuyTradingDealVolume, ForeignInstitutionalBuyTradingDealValue, 
    LocalIndividualSellTradingDealVolume, LocalIndividualSellTradingDealValue, 
    ForeignIndividualSellTradingDealVolume, ForeignIndividualSellTradingDealValue, 
    LocalInstitutionalSellTradingDealVolume, LocalInstitutionalSellTradingDealValue, 
    ForeignInstitutionalSellTradingDealVolume, ForeignInstitutionalSellTradingDealValue, HighestMatchVolume1Week, 
    HighestMatchVolume2Week, HighestMatchVolume1Month, HighestMatchVolume2Month, HighestMatchVolume3Month, 
    HighestMatchVolume6Month, HighestMatchVolume9Month, HighestMatchVolume1Year, HighestMatchVolumeYTD, 
    HighestMatchVolume52Week, HighestDealVolume1Week, HighestDealVolume2Week, HighestDealVolume1Month, 
    HighestDealVolume2Month, HighestDealVolume3Month, HighestDealVolume6Month, HighestDealVolume9Month, 
    HighestDealVolume1Year, HighestDealVolumeYTD, HighestDealVolume52Week, LowestMatchVolume1Week, 
    LowestMatchVolume2Week, LowestMatchVolume1Month, LowestMatchVolume2Month, LowestMatchVolume3Month, 
    LowestMatchVolume6Month, LowestMatchVolume9Month, LowestMatchVolume1Year, LowestMatchVolumeYTD, 
    LowestMatchVolume52Week, LowestDealVolume1Week, LowestDealVolume2Week, LowestDealVolume1Month, 
    LowestDealVolume2Month, LowestDealVolume3Month, LowestDealVolume6Month, LowestDealVolume9Month, 
    LowestDealVolume1Year, LowestDealVolumeYTD, LowestDealVolume52Week, HighestMatchValue1Week, 
    HighestMatchValue2Week, HighestMatchValue1Month, HighestMatchValue2Month, HighestMatchValue3Month, 
    HighestMatchValue6Month, HighestMatchValue9Month, HighestMatchValue1Year, HighestMatchValueYTD, 
    HighestMatchValue52Week, HighestDealValue1Week, HighestDealValue2Week, HighestDealValue1Month, 
    HighestDealValue2Month, HighestDealValue3Month, HighestDealValue6Month, HighestDealValue9Month, 
    HighestDealValue1Year, HighestDealValueYTD, HighestDealValue52Week, LowestMatchValue1Week, 
    LowestMatchValue2Week, LowestMatchValue1Month, LowestMatchValue2Month, LowestMatchValue3Month, 
    LowestMatchValue6Month, LowestMatchValue9Month, LowestMatchValue1Year, LowestMatchValueYTD, 
    LowestMatchValue52Week, LowestDealValue1Week, LowestDealValue2Week, LowestDealValue1Month, 
    LowestDealValue2Month, LowestDealValue3Month, LowestDealValue6Month, LowestDealValue9Month, 
    LowestDealValue1Year, LowestDealValueYTD, LowestDealValue52Week, PercentHighestTotalVolume1Week, 
    PercentHighestTotalVolume2Week, PercentHighestTotalVolume1Month, PercentHighestTotalVolume2Month, 
    PercentHighestTotalVolume3Month, PercentHighestTotalVolume6Month, PercentHighestTotalVolume9Month, 
    PercentHighestTotalVolume1Year, PercentHighestTotalVolumeYTD, PercentHighestTotalVolume52Week, 
    PercentHighestTotalMatchVolume1Week, PercentHighestTotalMatchVolume2Week, 
    PercentHighestTotalMatchVolume1Month, PercentHighestTotalMatchVolume2Month, 
    PercentHighestTotalMatchVolume3Month, PercentHighestTotalMatchVolume6Month, 
    PercentHighestTotalMatchVolume9Month, PercentHighestTotalMatchVolume1Year, PercentHighestTotalMatchVolumeYTD, 
    PercentHighestTotalMatchVolume52Week, PercentHighestTotalDealVolume1Week, PercentHighestTotalDealVolume2Week, 
    PercentHighestTotalDealVolume1Month, PercentHighestTotalDealVolume2Month, 
    PercentHighestTotalDealVolume3Month, PercentHighestTotalDealVolume6Month, 
    PercentHighestTotalDealVolume9Month, PercentHighestTotalDealVolume1Year, PercentHighestTotalDealVolumeYTD, 
    PercentHighestTotalDealVolume52Week, PercentHighestTotalValue1Week, PercentHighestTotalValue2Week, 
    PercentHighestTotalValue1Month, PercentHighestTotalValue2Month, PercentHighestTotalValue3Month, 
    PercentHighestTotalValue6Month, PercentHighestTotalValue9Month, PercentHighestTotalValueYTD, 
    PercentHighestTotalValue1Year, PercentHighestTotalValue52Week, PercentHighestTotalMatchValue1Week, 
    PercentHighestTotalMatchValue2Week, PercentHighestTotalMatchValue1Month, PercentHighestTotalMatchValue2Month, 
    PercentHighestTotalMatchValue3Month, PercentHighestTotalMatchValue6Month, 
    PercentHighestTotalMatchValue9Month, PercentHighestTotalMatchValue1Year, PercentHighestTotalMatchValueYTD, 
    PercentHighestTotalMatchValue52Week, PercentHighestTotalDealValue1Week, PercentHighestTotalDealValue2Week, 
    PercentHighestTotalDealValue1Month, PercentHighestTotalDealValue2Month, PercentHighestTotalDealValue3Month, 
    PercentHighestTotalDealValue6Month, PercentHighestTotalDealValue9Month, PercentHighestTotalDealValue1Year, 
    PercentHighestTotalDealValueYTD, PercentHighestTotalDealValue52Week, PercentLowestTotalVolume1Week, 
    PercentLowestTotalVolume2Week, PercentLowestTotalVolume1Month, PercentLowestTotalVolume2Month, 
    PercentLowestTotalVolume3Month, PercentLowestTotalVolume6Month, PercentLowestTotalVolume9Month, 
    PercentLowestTotalVolume1Year, PercentLowestTotalVolumeYTD, PercentLowestTotalVolume52Week, 
    PercentLowestTotalMatchVolume1Week, PercentLowestTotalMatchVolume2Week, PercentLowestTotalMatchVolume1Month, 
    PercentLowestTotalMatchVolume2Month, PercentLowestTotalMatchVolume3Month, 
    PercentLowestTotalMatchVolume6Month, PercentLowestTotalMatchVolume9Month, PercentLowestTotalMatchVolume1Year, 
    PercentLowestTotalMatchVolumeYTD, PercentLowestTotalMatchVolume52Week, PercentLowestTotalDealVolume1Week, 
    PercentLowestTotalDealVolume2Week, PercentLowestTotalDealVolume1Month, PercentLowestTotalDealVolume2Month, 
    PercentLowestTotalDealVolume3Month, PercentLowestTotalDealVolume6Month, PercentLowestTotalDealVolume9Month, 
    PercentLowestTotalDealVolume1Year, PercentLowestTotalDealVolumeYTD, PercentLowestTotalDealVolume52Week, 
    PercentLowestTotalValue1Week, PercentLowestTotalValue2Week, PercentLowestTotalValue1Month, 
    PercentLowestTotalValue2Month, PercentLowestTotalValue3Month, PercentLowestTotalValue6Month, 
    PercentLowestTotalValue9Month, PercentLowestTotalValueYTD, PercentLowestTotalValue1Year, 
    PercentLowestTotalValue52Week, PercentLowestTotalMatchValue1Week, PercentLowestTotalMatchValue2Week, 
    PercentLowestTotalMatchValue1Month, PercentLowestTotalMatchValue2Month, PercentLowestTotalMatchValue3Month, 
    PercentLowestTotalMatchValue6Month, PercentLowestTotalMatchValue9Month, PercentLowestTotalMatchValue1Year, 
    PercentLowestTotalMatchValueYTD, PercentLowestTotalMatchValue52Week, PercentLowestTotalDealValue1Week, 
    PercentLowestTotalDealValue2Week, PercentLowestTotalDealValue1Month, PercentLowestTotalDealValue2Month, 
    PercentLowestTotalDealValue3Month, PercentLowestTotalDealValue6Month, PercentLowestTotalDealValue9Month, 
    PercentLowestTotalDealValue1Year, PercentLowestTotalDealValueYTD, PercentLowestTotalDealValue52Week, 
    AverageDealVolume1Week, AverageDealVolume2Week, AverageDealVolume1Month, AverageDealVolume2Month, 
    AverageDealVolume3Month, AverageDealVolume6Month, AverageDealVolume9Month, AverageDealVolume1Year, 
    AverageDealVolumeYTD, AverageDealVolume52Week, AverageDealValue1Week, AverageDealValue2Week, 
    AverageDealValue1Month, AverageDealValue2Month, AverageDealValue3Month, AverageDealValue6Month, 
    AverageDealValue9Month, AverageDealValue1Year, AverageDealValueYTD, AverageDealValue52Week, 
    AveragePrice1Week, AveragePrice2Week, AveragePrice1Month, AveragePrice2Month, AveragePrice3Month, 
    AveragePrice6Month, AveragePrice9Month, AveragePrice1Year, AveragePriceYTD, AveragePrice52Week) VALUES (%s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s) ON CONFLICT ON CONSTRAINT xpkstx_fsc_returnstock DO UPDATE SET (ReturnStockId, OrganCode, 
    ComGroupCode, Ticker, TradingDate, Status, CreateDate, UpdateDate, HighestPrice1Week, HighestPrice2Week, 
    HighestPrice1Month, HighestPrice2Month, HighestPrice3Month, HighestPrice6Month, HighestPrice9Month, 
    HighestPrice1Year, HighestPriceYTD, HighestPrice52Week, LowestPrice1Week, LowestPrice2Week, 
    LowestPrice1Month, LowestPrice2Month, LowestPrice3Month, LowestPrice6Month, LowestPrice9Month, 
    LowestPrice1Year, LowestPriceYTD, LowestPrice52Week, PriceChange1Day, PriceChange1Week, PriceChange2Week, 
    PriceChange1Month, PriceChange2Month, PriceChange3Month, PriceChange6Month, PriceChange9Month, 
    PriceChange1Year, PriceChangeYTD, PriceChange52Week, PercentPriceChange1Day, PercentPriceChange1Week, 
    PercentPriceChange2Week, PercentPriceChange1Month, PercentPriceChange2Month, PercentPriceChange3Month, 
    PercentPriceChange6Month, PercentPriceChange9Month, PercentPriceChange1Year, PercentPriceChangeYTD, 
    PercentPriceChange52Week, AverageVolume1Week, AverageVolume2Week, AverageVolume1Month, AverageVolume2Month, 
    AverageVolume3Month, AverageVolume6Month, AverageVolume9Month, AverageVolume1Year, AverageVolumeYTD, 
    AverageVolume52Week, HighestVolume1Week, HighestVolume2Week, HighestVolume1Month, HighestVolume2Month, 
    HighestVolume3Month, HighestVolume6Month, HighestVolume9Month, HighestVolume1Year, HighestVolumeYTD, 
    HighestVolume52Week, LowestVolume1Week, LowestVolume2Week, LowestVolume1Month, LowestVolume2Month, 
    LowestVolume3Month, LowestVolume6Month, LowestVolume9Month, LowestVolume1Year, LowestVolumeYTD, 
    LowestVolume52Week, AverageValue1Week, AverageValue2Week, AverageValue1Month, AverageValue2Month, 
    AverageValue3Month, AverageValue6Month, AverageValue9Month, AverageValue1Year, AverageValueYTD, 
    AverageValue52Week, HighestValue1Week, HighestValue2Week, HighestValue1Month, HighestValue2Month, 
    HighestValue3Month, HighestValue6Month, HighestValue9Month, HighestValue1Year, HighestValueYTD, 
    HighestValue52Week, LowestValue1Week, LowestValue2Week, LowestValue1Month, LowestValue2Month, 
    LowestValue3Month, LowestValue6Month, LowestValue9Month, LowestValue1Year, LowestValueYTD, LowestValue52Week, 
    AverageMatchVolume1Week, AverageMatchVolume2Week, AverageMatchVolume1Month, AverageMatchVolume2Month, 
    AverageMatchVolume3Month, AverageMatchVolume6Month, AverageMatchVolume9Month, AverageMatchVolume1Year, 
    AverageMatchVolumeYTD, AverageMatchVolume52Week, AverageMatchValue1Week, AverageMatchValue2Week, 
    AverageMatchValue1Month, AverageMatchValue2Month, AverageMatchValue3Month, AverageMatchValue6Month, 
    AverageMatchValue9Month, AverageMatchValue1Year, AverageMatchValueYTD, AverageMatchValue52Week, 
    PercentHighestPriceChange1Week, PercentHighestPriceChange2Week, PercentHighestPriceChange1Month, 
    PercentHighestPriceChange2Month, PercentHighestPriceChange3Month, PercentHighestPriceChange6Month, 
    PercentHighestPriceChange9Month, PercentHighestPriceChange1Year, PercentHighestPriceChangeYTD, 
    PercentHighestPriceChange52Week, PercentLowestPriceChange1Week, PercentLowestPriceChange2Week, 
    PercentLowestPriceChange1Month, PercentLowestPriceChange2Month, PercentLowestPriceChange3Month, 
    PercentLowestPriceChange6Month, PercentLowestPriceChange9Month, PercentLowestPriceChange1Year, 
    PercentLowestPriceChangeYTD, PercentLowestPriceChange52Week, PercentPriceChangeFromHighest, 
    PercentPriceChangeFromLowest, PercentPriceChangeFTD, PercentMatchVolumeChange1Week, 
    PercentMatchVolumeChange2Week, PercentMatchVolumeChange1Month, PercentMatchVolumeChange2Month, 
    PercentMatchVolumeChange3Month, PercentMatchVolumeChange6Month, PercentMatchVolumeChange9Month, 
    PercentMatchVolumeChange1Year, PercentMatchVolumeChangeYTD, PercentMatchVolumeChange52Week, VWAP1Day, 
    VWAP1Week, VWAP2Week, VWAP1Month, VWAP2Month, VWAP3Month, VWAP6Month, VWAP9Month, VWAP1Year, VWAPYTD, 
    VWAP52Week, LocalIndividualBuyTradingMatchVolume, LocalIndividualBuyTradingMatchValue, 
    ForeignIndividualBuyTradingMatchVolume, ForeignIndividualBuyTradingMatchValue, 
    LocalInstitutionalBuyTradingMatchVolume, LocalInstitutionalBuyTradingMatchValue, 
    ForeignInstitutionalBuyTradingMatchVolume, ForeignInstitutionalBuyTradingMatchValue, 
    LocalIndividualSellTradingMatchVolume, LocalIndividualSellTradingMatchValue, 
    ForeignIndividualSellTradingMatchVolume, ForeignIndividualSellTradingMatchValue, 
    LocalInstitutionalSellTradingMatchVolume, LocalInstitutionalSellTradingMatchValue, 
    ForeignInstitutionalSellTradingMatchVolume, ForeignInstitutionalSellTradingMatchValue, 
    LocalIndividualBuyTradingDealVolume, LocalIndividualBuyTradingDealValue, 
    ForeignIndividualBuyTradingDealVolume, ForeignIndividualBuyTradingDealValue, 
    LocalInstitutionalBuyTradingDealVolume, LocalInstitutionalBuyTradingDealValue, 
    ForeignInstitutionalBuyTradingDealVolume, ForeignInstitutionalBuyTradingDealValue, 
    LocalIndividualSellTradingDealVolume, LocalIndividualSellTradingDealValue, 
    ForeignIndividualSellTradingDealVolume, ForeignIndividualSellTradingDealValue, 
    LocalInstitutionalSellTradingDealVolume, LocalInstitutionalSellTradingDealValue, 
    ForeignInstitutionalSellTradingDealVolume, ForeignInstitutionalSellTradingDealValue, HighestMatchVolume1Week, 
    HighestMatchVolume2Week, HighestMatchVolume1Month, HighestMatchVolume2Month, HighestMatchVolume3Month, 
    HighestMatchVolume6Month, HighestMatchVolume9Month, HighestMatchVolume1Year, HighestMatchVolumeYTD, 
    HighestMatchVolume52Week, HighestDealVolume1Week, HighestDealVolume2Week, HighestDealVolume1Month, 
    HighestDealVolume2Month, HighestDealVolume3Month, HighestDealVolume6Month, HighestDealVolume9Month, 
    HighestDealVolume1Year, HighestDealVolumeYTD, HighestDealVolume52Week, LowestMatchVolume1Week, 
    LowestMatchVolume2Week, LowestMatchVolume1Month, LowestMatchVolume2Month, LowestMatchVolume3Month, 
    LowestMatchVolume6Month, LowestMatchVolume9Month, LowestMatchVolume1Year, LowestMatchVolumeYTD, 
    LowestMatchVolume52Week, LowestDealVolume1Week, LowestDealVolume2Week, LowestDealVolume1Month, 
    LowestDealVolume2Month, LowestDealVolume3Month, LowestDealVolume6Month, LowestDealVolume9Month, 
    LowestDealVolume1Year, LowestDealVolumeYTD, LowestDealVolume52Week, HighestMatchValue1Week, 
    HighestMatchValue2Week, HighestMatchValue1Month, HighestMatchValue2Month, HighestMatchValue3Month, 
    HighestMatchValue6Month, HighestMatchValue9Month, HighestMatchValue1Year, HighestMatchValueYTD, 
    HighestMatchValue52Week, HighestDealValue1Week, HighestDealValue2Week, HighestDealValue1Month, 
    HighestDealValue2Month, HighestDealValue3Month, HighestDealValue6Month, HighestDealValue9Month, 
    HighestDealValue1Year, HighestDealValueYTD, HighestDealValue52Week, LowestMatchValue1Week, 
    LowestMatchValue2Week, LowestMatchValue1Month, LowestMatchValue2Month, LowestMatchValue3Month, 
    LowestMatchValue6Month, LowestMatchValue9Month, LowestMatchValue1Year, LowestMatchValueYTD, 
    LowestMatchValue52Week, LowestDealValue1Week, LowestDealValue2Week, LowestDealValue1Month, 
    LowestDealValue2Month, LowestDealValue3Month, LowestDealValue6Month, LowestDealValue9Month, 
    LowestDealValue1Year, LowestDealValueYTD, LowestDealValue52Week, PercentHighestTotalVolume1Week, 
    PercentHighestTotalVolume2Week, PercentHighestTotalVolume1Month, PercentHighestTotalVolume2Month, 
    PercentHighestTotalVolume3Month, PercentHighestTotalVolume6Month, PercentHighestTotalVolume9Month, 
    PercentHighestTotalVolume1Year, PercentHighestTotalVolumeYTD, PercentHighestTotalVolume52Week, 
    PercentHighestTotalMatchVolume1Week, PercentHighestTotalMatchVolume2Week, 
    PercentHighestTotalMatchVolume1Month, PercentHighestTotalMatchVolume2Month, 
    PercentHighestTotalMatchVolume3Month, PercentHighestTotalMatchVolume6Month, 
    PercentHighestTotalMatchVolume9Month, PercentHighestTotalMatchVolume1Year, PercentHighestTotalMatchVolumeYTD, 
    PercentHighestTotalMatchVolume52Week, PercentHighestTotalDealVolume1Week, PercentHighestTotalDealVolume2Week, 
    PercentHighestTotalDealVolume1Month, PercentHighestTotalDealVolume2Month, 
    PercentHighestTotalDealVolume3Month, PercentHighestTotalDealVolume6Month, 
    PercentHighestTotalDealVolume9Month, PercentHighestTotalDealVolume1Year, PercentHighestTotalDealVolumeYTD, 
    PercentHighestTotalDealVolume52Week, PercentHighestTotalValue1Week, PercentHighestTotalValue2Week, 
    PercentHighestTotalValue1Month, PercentHighestTotalValue2Month, PercentHighestTotalValue3Month, 
    PercentHighestTotalValue6Month, PercentHighestTotalValue9Month, PercentHighestTotalValueYTD, 
    PercentHighestTotalValue1Year, PercentHighestTotalValue52Week, PercentHighestTotalMatchValue1Week, 
    PercentHighestTotalMatchValue2Week, PercentHighestTotalMatchValue1Month, PercentHighestTotalMatchValue2Month, 
    PercentHighestTotalMatchValue3Month, PercentHighestTotalMatchValue6Month, 
    PercentHighestTotalMatchValue9Month, PercentHighestTotalMatchValue1Year, PercentHighestTotalMatchValueYTD, 
    PercentHighestTotalMatchValue52Week, PercentHighestTotalDealValue1Week, PercentHighestTotalDealValue2Week, 
    PercentHighestTotalDealValue1Month, PercentHighestTotalDealValue2Month, PercentHighestTotalDealValue3Month, 
    PercentHighestTotalDealValue6Month, PercentHighestTotalDealValue9Month, PercentHighestTotalDealValue1Year, 
    PercentHighestTotalDealValueYTD, PercentHighestTotalDealValue52Week, PercentLowestTotalVolume1Week, 
    PercentLowestTotalVolume2Week, PercentLowestTotalVolume1Month, PercentLowestTotalVolume2Month, 
    PercentLowestTotalVolume3Month, PercentLowestTotalVolume6Month, PercentLowestTotalVolume9Month, 
    PercentLowestTotalVolume1Year, PercentLowestTotalVolumeYTD, PercentLowestTotalVolume52Week, 
    PercentLowestTotalMatchVolume1Week, PercentLowestTotalMatchVolume2Week, PercentLowestTotalMatchVolume1Month, 
    PercentLowestTotalMatchVolume2Month, PercentLowestTotalMatchVolume3Month, 
    PercentLowestTotalMatchVolume6Month, PercentLowestTotalMatchVolume9Month, PercentLowestTotalMatchVolume1Year, 
    PercentLowestTotalMatchVolumeYTD, PercentLowestTotalMatchVolume52Week, PercentLowestTotalDealVolume1Week, 
    PercentLowestTotalDealVolume2Week, PercentLowestTotalDealVolume1Month, PercentLowestTotalDealVolume2Month, 
    PercentLowestTotalDealVolume3Month, PercentLowestTotalDealVolume6Month, PercentLowestTotalDealVolume9Month, 
    PercentLowestTotalDealVolume1Year, PercentLowestTotalDealVolumeYTD, PercentLowestTotalDealVolume52Week, 
    PercentLowestTotalValue1Week, PercentLowestTotalValue2Week, PercentLowestTotalValue1Month, 
    PercentLowestTotalValue2Month, PercentLowestTotalValue3Month, PercentLowestTotalValue6Month, 
    PercentLowestTotalValue9Month, PercentLowestTotalValueYTD, PercentLowestTotalValue1Year, 
    PercentLowestTotalValue52Week, PercentLowestTotalMatchValue1Week, PercentLowestTotalMatchValue2Week, 
    PercentLowestTotalMatchValue1Month, PercentLowestTotalMatchValue2Month, PercentLowestTotalMatchValue3Month, 
    PercentLowestTotalMatchValue6Month, PercentLowestTotalMatchValue9Month, PercentLowestTotalMatchValue1Year, 
    PercentLowestTotalMatchValueYTD, PercentLowestTotalMatchValue52Week, PercentLowestTotalDealValue1Week, 
    PercentLowestTotalDealValue2Week, PercentLowestTotalDealValue1Month, PercentLowestTotalDealValue2Month, 
    PercentLowestTotalDealValue3Month, PercentLowestTotalDealValue6Month, PercentLowestTotalDealValue9Month, 
    PercentLowestTotalDealValue1Year, PercentLowestTotalDealValueYTD, PercentLowestTotalDealValue52Week, 
    AverageDealVolume1Week, AverageDealVolume2Week, AverageDealVolume1Month, AverageDealVolume2Month, 
    AverageDealVolume3Month, AverageDealVolume6Month, AverageDealVolume9Month, AverageDealVolume1Year, 
    AverageDealVolumeYTD, AverageDealVolume52Week, AverageDealValue1Week, AverageDealValue2Week, 
    AverageDealValue1Month, AverageDealValue2Month, AverageDealValue3Month, AverageDealValue6Month, 
    AverageDealValue9Month, AverageDealValue1Year, AverageDealValueYTD, AverageDealValue52Week, 
    AveragePrice1Week, AveragePrice2Week, AveragePrice1Month, AveragePrice2Month, AveragePrice3Month, 
    AveragePrice6Month, AveragePrice9Month, AveragePrice1Year, AveragePriceYTD, AveragePrice52Week) = (
    EXCLUDED.ReturnStockId, EXCLUDED.OrganCode, EXCLUDED.ComGroupCode, EXCLUDED.Ticker, EXCLUDED. TradingDate, 
    EXCLUDED.Status, EXCLUDED.CreateDate, EXCLUDED.UpdateDate, EXCLUDED.HighestPrice1Week, 
    EXCLUDED.HighestPrice2Week, EXCLUDED.HighestPrice1Month, EXCLUDED. HighestPrice2Month, 
    EXCLUDED.HighestPrice3Month, EXCLUDED.HighestPrice6Month, EXCLUDED.HighestPrice9Month, 
    EXCLUDED.HighestPrice1Year, EXCLUDED. HighestPriceYTD, EXCLUDED.HighestPrice52Week, 
    EXCLUDED.LowestPrice1Week, EXCLUDED.LowestPrice2Week, EXCLUDED.LowestPrice1Month, EXCLUDED. 
    LowestPrice2Month, EXCLUDED.LowestPrice3Month, EXCLUDED.LowestPrice6Month, EXCLUDED.LowestPrice9Month, 
    EXCLUDED.LowestPrice1Year, EXCLUDED.LowestPriceYTD, EXCLUDED. LowestPrice52Week, EXCLUDED.PriceChange1Day, 
    EXCLUDED.PriceChange1Week, EXCLUDED.PriceChange2Week, EXCLUDED.PriceChange1Month, EXCLUDED.PriceChange2Month, 
    EXCLUDED. PriceChange3Month, EXCLUDED.PriceChange6Month, EXCLUDED.PriceChange9Month, 
    EXCLUDED.PriceChange1Year, EXCLUDED.PriceChangeYTD, EXCLUDED.PriceChange52Week, EXCLUDED. 
    PercentPriceChange1Day, EXCLUDED.PercentPriceChange1Week, EXCLUDED.PercentPriceChange2Week, 
    EXCLUDED.PercentPriceChange1Month, EXCLUDED. PercentPriceChange2Month, EXCLUDED.PercentPriceChange3Month, 
    EXCLUDED.PercentPriceChange6Month, EXCLUDED.PercentPriceChange9Month, EXCLUDED. PercentPriceChange1Year, 
    EXCLUDED.PercentPriceChangeYTD, EXCLUDED.PercentPriceChange52Week, EXCLUDED.AverageVolume1Week, 
    EXCLUDED. AverageVolume2Week, EXCLUDED.AverageVolume1Month, EXCLUDED.AverageVolume2Month, 
    EXCLUDED.AverageVolume3Month, EXCLUDED.AverageVolume6Month, EXCLUDED. AverageVolume9Month, 
    EXCLUDED.AverageVolume1Year, EXCLUDED.AverageVolumeYTD, EXCLUDED.AverageVolume52Week, 
    EXCLUDED.HighestVolume1Week, EXCLUDED. HighestVolume2Week, EXCLUDED.HighestVolume1Month, 
    EXCLUDED.HighestVolume2Month, EXCLUDED.HighestVolume3Month, EXCLUDED.HighestVolume6Month, EXCLUDED. 
    HighestVolume9Month, EXCLUDED.HighestVolume1Year, EXCLUDED.HighestVolumeYTD, EXCLUDED.HighestVolume52Week, 
    EXCLUDED.LowestVolume1Week, EXCLUDED. LowestVolume2Week, EXCLUDED.LowestVolume1Month, 
    EXCLUDED.LowestVolume2Month, EXCLUDED.LowestVolume3Month, EXCLUDED.LowestVolume6Month, EXCLUDED. 
    LowestVolume9Month, EXCLUDED.LowestVolume1Year, EXCLUDED.LowestVolumeYTD, EXCLUDED.LowestVolume52Week, 
    EXCLUDED.AverageValue1Week, EXCLUDED. AverageValue2Week, EXCLUDED.AverageValue1Month, 
    EXCLUDED.AverageValue2Month, EXCLUDED.AverageValue3Month, EXCLUDED.AverageValue6Month, EXCLUDED. 
    AverageValue9Month, EXCLUDED.AverageValue1Year, EXCLUDED.AverageValueYTD, EXCLUDED.AverageValue52Week, 
    EXCLUDED.HighestValue1Week, EXCLUDED. HighestValue2Week, EXCLUDED.HighestValue1Month, 
    EXCLUDED.HighestValue2Month, EXCLUDED.HighestValue3Month, EXCLUDED.HighestValue6Month, EXCLUDED. 
    HighestValue9Month, EXCLUDED.HighestValue1Year, EXCLUDED.HighestValueYTD, EXCLUDED.HighestValue52Week, 
    EXCLUDED.LowestValue1Week, EXCLUDED. LowestValue2Week, EXCLUDED.LowestValue1Month, 
    EXCLUDED.LowestValue2Month, EXCLUDED.LowestValue3Month, EXCLUDED.LowestValue6Month, EXCLUDED. 
    LowestValue9Month, EXCLUDED.LowestValue1Year, EXCLUDED.LowestValueYTD, EXCLUDED.LowestValue52Week, 
    EXCLUDED.AverageMatchVolume1Week, EXCLUDED. AverageMatchVolume2Week, EXCLUDED.AverageMatchVolume1Month, 
    EXCLUDED.AverageMatchVolume2Month, EXCLUDED.AverageMatchVolume3Month, EXCLUDED. AverageMatchVolume6Month, 
    EXCLUDED.AverageMatchVolume9Month, EXCLUDED.AverageMatchVolume1Year, EXCLUDED.AverageMatchVolumeYTD, 
    EXCLUDED. AverageMatchVolume52Week, EXCLUDED.AverageMatchValue1Week, EXCLUDED.AverageMatchValue2Week, 
    EXCLUDED.AverageMatchValue1Month, EXCLUDED. AverageMatchValue2Month, EXCLUDED.AverageMatchValue3Month, 
    EXCLUDED.AverageMatchValue6Month, EXCLUDED.AverageMatchValue9Month, EXCLUDED. AverageMatchValue1Year, 
    EXCLUDED.AverageMatchValueYTD, EXCLUDED.AverageMatchValue52Week, EXCLUDED.PercentHighestPriceChange1Week, 
    EXCLUDED. PercentHighestPriceChange2Week, EXCLUDED.PercentHighestPriceChange1Month, 
    EXCLUDED.PercentHighestPriceChange2Month, EXCLUDED. PercentHighestPriceChange3Month, 
    EXCLUDED.PercentHighestPriceChange6Month, EXCLUDED.PercentHighestPriceChange9Month, EXCLUDED. 
    PercentHighestPriceChange1Year, EXCLUDED.PercentHighestPriceChangeYTD, 
    EXCLUDED.PercentHighestPriceChange52Week, EXCLUDED. PercentLowestPriceChange1Week, 
    EXCLUDED.PercentLowestPriceChange2Week, EXCLUDED.PercentLowestPriceChange1Month, EXCLUDED. 
    PercentLowestPriceChange2Month, EXCLUDED.PercentLowestPriceChange3Month, 
    EXCLUDED.PercentLowestPriceChange6Month, EXCLUDED. PercentLowestPriceChange9Month, 
    EXCLUDED.PercentLowestPriceChange1Year, EXCLUDED.PercentLowestPriceChangeYTD, EXCLUDED. 
    PercentLowestPriceChange52Week, EXCLUDED.PercentPriceChangeFromHighest, 
    EXCLUDED.PercentPriceChangeFromLowest, EXCLUDED. PercentPriceChangeFTD, 
    EXCLUDED.PercentMatchVolumeChange1Week, EXCLUDED.PercentMatchVolumeChange2Week, EXCLUDED. 
    PercentMatchVolumeChange1Month, EXCLUDED.PercentMatchVolumeChange2Month, 
    EXCLUDED.PercentMatchVolumeChange3Month, EXCLUDED. PercentMatchVolumeChange6Month, 
    EXCLUDED.PercentMatchVolumeChange9Month, EXCLUDED.PercentMatchVolumeChange1Year, EXCLUDED. 
    PercentMatchVolumeChangeYTD, EXCLUDED.PercentMatchVolumeChange52Week, EXCLUDED.VWAP1Day, EXCLUDED.VWAP1Week, 
    EXCLUDED.VWAP2Week, EXCLUDED.VWAP1Month, EXCLUDED. VWAP2Month, EXCLUDED.VWAP3Month, EXCLUDED.VWAP6Month, 
    EXCLUDED.VWAP9Month, EXCLUDED.VWAP1Year, EXCLUDED.VWAPYTD, EXCLUDED.VWAP52Week, EXCLUDED. 
    LocalIndividualBuyTradingMatchVolume, EXCLUDED.LocalIndividualBuyTradingMatchValue, EXCLUDED. 
    ForeignIndividualBuyTradingMatchVolume, EXCLUDED.ForeignIndividualBuyTradingMatchValue, EXCLUDED. 
    LocalInstitutionalBuyTradingMatchVolume, EXCLUDED.LocalInstitutionalBuyTradingMatchValue, EXCLUDED. 
    ForeignInstitutionalBuyTradingMatchVolume, EXCLUDED.ForeignInstitutionalBuyTradingMatchValue, 
    EXCLUDED. LocalIndividualSellTradingMatchVolume, EXCLUDED.LocalIndividualSellTradingMatchValue, 
    EXCLUDED. ForeignIndividualSellTradingMatchVolume, EXCLUDED.ForeignIndividualSellTradingMatchValue, 
    EXCLUDED. LocalInstitutionalSellTradingMatchVolume, EXCLUDED.LocalInstitutionalSellTradingMatchValue, 
    EXCLUDED. ForeignInstitutionalSellTradingMatchVolume, EXCLUDED.ForeignInstitutionalSellTradingMatchValue, 
    EXCLUDED. LocalIndividualBuyTradingDealVolume, EXCLUDED.LocalIndividualBuyTradingDealValue, EXCLUDED. 
    ForeignIndividualBuyTradingDealVolume, EXCLUDED.ForeignIndividualBuyTradingDealValue, EXCLUDED. 
    LocalInstitutionalBuyTradingDealVolume, EXCLUDED.LocalInstitutionalBuyTradingDealValue, EXCLUDED. 
    ForeignInstitutionalBuyTradingDealVolume, EXCLUDED.ForeignInstitutionalBuyTradingDealValue, EXCLUDED. 
    LocalIndividualSellTradingDealVolume, EXCLUDED.LocalIndividualSellTradingDealValue, EXCLUDED. 
    ForeignIndividualSellTradingDealVolume, EXCLUDED.ForeignIndividualSellTradingDealValue, EXCLUDED. 
    LocalInstitutionalSellTradingDealVolume, EXCLUDED.LocalInstitutionalSellTradingDealValue, EXCLUDED. 
    ForeignInstitutionalSellTradingDealVolume, EXCLUDED.ForeignInstitutionalSellTradingDealValue, 
    EXCLUDED.HighestMatchVolume1Week, EXCLUDED. HighestMatchVolume2Week, EXCLUDED.HighestMatchVolume1Month, 
    EXCLUDED.HighestMatchVolume2Month, EXCLUDED.HighestMatchVolume3Month, EXCLUDED. HighestMatchVolume6Month, 
    EXCLUDED.HighestMatchVolume9Month, EXCLUDED.HighestMatchVolume1Year, EXCLUDED.HighestMatchVolumeYTD, 
    EXCLUDED. HighestMatchVolume52Week, EXCLUDED.HighestDealVolume1Week, EXCLUDED.HighestDealVolume2Week, 
    EXCLUDED.HighestDealVolume1Month, EXCLUDED. HighestDealVolume2Month, EXCLUDED.HighestDealVolume3Month, 
    EXCLUDED.HighestDealVolume6Month, EXCLUDED.HighestDealVolume9Month, EXCLUDED. HighestDealVolume1Year, 
    EXCLUDED.HighestDealVolumeYTD, EXCLUDED.HighestDealVolume52Week, EXCLUDED.LowestMatchVolume1Week, 
    EXCLUDED. LowestMatchVolume2Week, EXCLUDED.LowestMatchVolume1Month, EXCLUDED.LowestMatchVolume2Month, 
    EXCLUDED.LowestMatchVolume3Month, EXCLUDED. LowestMatchVolume6Month, EXCLUDED.LowestMatchVolume9Month, 
    EXCLUDED.LowestMatchVolume1Year, EXCLUDED.LowestMatchVolumeYTD, EXCLUDED. LowestMatchVolume52Week, 
    EXCLUDED.LowestDealVolume1Week, EXCLUDED.LowestDealVolume2Week, EXCLUDED.LowestDealVolume1Month, 
    EXCLUDED. LowestDealVolume2Month, EXCLUDED.LowestDealVolume3Month, EXCLUDED.LowestDealVolume6Month, 
    EXCLUDED.LowestDealVolume9Month, EXCLUDED. LowestDealVolume1Year, EXCLUDED.LowestDealVolumeYTD, 
    EXCLUDED.LowestDealVolume52Week, EXCLUDED.HighestMatchValue1Week, EXCLUDED. HighestMatchValue2Week, 
    EXCLUDED.HighestMatchValue1Month, EXCLUDED.HighestMatchValue2Month, EXCLUDED.HighestMatchValue3Month, 
    EXCLUDED. HighestMatchValue6Month, EXCLUDED.HighestMatchValue9Month, EXCLUDED.HighestMatchValue1Year, 
    EXCLUDED.HighestMatchValueYTD, EXCLUDED. HighestMatchValue52Week, EXCLUDED.HighestDealValue1Week, 
    EXCLUDED.HighestDealValue2Week, EXCLUDED.HighestDealValue1Month, EXCLUDED. HighestDealValue2Month, 
    EXCLUDED.HighestDealValue3Month, EXCLUDED.HighestDealValue6Month, EXCLUDED.HighestDealValue9Month, 
    EXCLUDED. HighestDealValue1Year, EXCLUDED.HighestDealValueYTD, EXCLUDED.HighestDealValue52Week, 
    EXCLUDED.LowestMatchValue1Week, EXCLUDED. LowestMatchValue2Week, EXCLUDED.LowestMatchValue1Month, 
    EXCLUDED.LowestMatchValue2Month, EXCLUDED.LowestMatchValue3Month, EXCLUDED. LowestMatchValue6Month, 
    EXCLUDED.LowestMatchValue9Month, EXCLUDED.LowestMatchValue1Year, EXCLUDED.LowestMatchValueYTD, 
    EXCLUDED. LowestMatchValue52Week, EXCLUDED.LowestDealValue1Week, EXCLUDED.LowestDealValue2Week, 
    EXCLUDED.LowestDealValue1Month, EXCLUDED. LowestDealValue2Month, EXCLUDED.LowestDealValue3Month, 
    EXCLUDED.LowestDealValue6Month, EXCLUDED.LowestDealValue9Month, EXCLUDED. LowestDealValue1Year, 
    EXCLUDED.LowestDealValueYTD, EXCLUDED.LowestDealValue52Week, EXCLUDED.PercentHighestTotalVolume1Week, 
    EXCLUDED. PercentHighestTotalVolume2Week, EXCLUDED.PercentHighestTotalVolume1Month, 
    EXCLUDED.PercentHighestTotalVolume2Month, EXCLUDED. PercentHighestTotalVolume3Month, 
    EXCLUDED.PercentHighestTotalVolume6Month, EXCLUDED.PercentHighestTotalVolume9Month, EXCLUDED. 
    PercentHighestTotalVolume1Year, EXCLUDED.PercentHighestTotalVolumeYTD, 
    EXCLUDED.PercentHighestTotalVolume52Week, EXCLUDED. PercentHighestTotalMatchVolume1Week, 
    EXCLUDED.PercentHighestTotalMatchVolume2Week, EXCLUDED. PercentHighestTotalMatchVolume1Month, 
    EXCLUDED.PercentHighestTotalMatchVolume2Month, EXCLUDED. PercentHighestTotalMatchVolume3Month, 
    EXCLUDED.PercentHighestTotalMatchVolume6Month, EXCLUDED. PercentHighestTotalMatchVolume9Month, 
    EXCLUDED.PercentHighestTotalMatchVolume1Year, EXCLUDED.PercentHighestTotalMatchVolumeYTD, EXCLUDED. 
    PercentHighestTotalMatchVolume52Week, EXCLUDED.PercentHighestTotalDealVolume1Week, 
    EXCLUDED.PercentHighestTotalDealVolume2Week, EXCLUDED. PercentHighestTotalDealVolume1Month, 
    EXCLUDED.PercentHighestTotalDealVolume2Month, EXCLUDED. PercentHighestTotalDealVolume3Month, 
    EXCLUDED.PercentHighestTotalDealVolume6Month, EXCLUDED. PercentHighestTotalDealVolume9Month, 
    EXCLUDED.PercentHighestTotalDealVolume1Year, EXCLUDED.PercentHighestTotalDealVolumeYTD, EXCLUDED. 
    PercentHighestTotalDealVolume52Week, EXCLUDED.PercentHighestTotalValue1Week, 
    EXCLUDED.PercentHighestTotalValue2Week, EXCLUDED. PercentHighestTotalValue1Month, 
    EXCLUDED.PercentHighestTotalValue2Month, EXCLUDED.PercentHighestTotalValue3Month, EXCLUDED. 
    PercentHighestTotalValue6Month, EXCLUDED.PercentHighestTotalValue9Month, 
    EXCLUDED.PercentHighestTotalValueYTD, EXCLUDED. PercentHighestTotalValue1Year, 
    EXCLUDED.PercentHighestTotalValue52Week, EXCLUDED.PercentHighestTotalMatchValue1Week, EXCLUDED. 
    PercentHighestTotalMatchValue2Week, EXCLUDED.PercentHighestTotalMatchValue1Month, 
    EXCLUDED.PercentHighestTotalMatchValue2Month, EXCLUDED. PercentHighestTotalMatchValue3Month, 
    EXCLUDED.PercentHighestTotalMatchValue6Month, EXCLUDED. PercentHighestTotalMatchValue9Month, 
    EXCLUDED.PercentHighestTotalMatchValue1Year, EXCLUDED.PercentHighestTotalMatchValueYTD, EXCLUDED. 
    PercentHighestTotalMatchValue52Week, EXCLUDED.PercentHighestTotalDealValue1Week, 
    EXCLUDED.PercentHighestTotalDealValue2Week, EXCLUDED. PercentHighestTotalDealValue1Month, 
    EXCLUDED.PercentHighestTotalDealValue2Month, EXCLUDED.PercentHighestTotalDealValue3Month, EXCLUDED. 
    PercentHighestTotalDealValue6Month, EXCLUDED.PercentHighestTotalDealValue9Month, 
    EXCLUDED.PercentHighestTotalDealValue1Year, EXCLUDED. PercentHighestTotalDealValueYTD, 
    EXCLUDED.PercentHighestTotalDealValue52Week, EXCLUDED.PercentLowestTotalVolume1Week, EXCLUDED. 
    PercentLowestTotalVolume2Week, EXCLUDED.PercentLowestTotalVolume1Month, 
    EXCLUDED.PercentLowestTotalVolume2Month, EXCLUDED. PercentLowestTotalVolume3Month, 
    EXCLUDED.PercentLowestTotalVolume6Month, EXCLUDED.PercentLowestTotalVolume9Month, EXCLUDED. 
    PercentLowestTotalVolume1Year, EXCLUDED.PercentLowestTotalVolumeYTD, EXCLUDED.PercentLowestTotalVolume52Week, 
    EXCLUDED. PercentLowestTotalMatchVolume1Week, EXCLUDED.PercentLowestTotalMatchVolume2Week, 
    EXCLUDED.PercentLowestTotalMatchVolume1Month, EXCLUDED. PercentLowestTotalMatchVolume2Month, 
    EXCLUDED.PercentLowestTotalMatchVolume3Month, EXCLUDED. PercentLowestTotalMatchVolume6Month, 
    EXCLUDED.PercentLowestTotalMatchVolume9Month, EXCLUDED.PercentLowestTotalMatchVolume1Year, EXCLUDED. 
    PercentLowestTotalMatchVolumeYTD, EXCLUDED.PercentLowestTotalMatchVolume52Week, 
    EXCLUDED.PercentLowestTotalDealVolume1Week, EXCLUDED. PercentLowestTotalDealVolume2Week, 
    EXCLUDED.PercentLowestTotalDealVolume1Month, EXCLUDED.PercentLowestTotalDealVolume2Month, EXCLUDED. 
    PercentLowestTotalDealVolume3Month, EXCLUDED.PercentLowestTotalDealVolume6Month, 
    EXCLUDED.PercentLowestTotalDealVolume9Month, EXCLUDED. PercentLowestTotalDealVolume1Year, 
    EXCLUDED.PercentLowestTotalDealVolumeYTD, EXCLUDED.PercentLowestTotalDealVolume52Week, EXCLUDED. 
    PercentLowestTotalValue1Week, EXCLUDED.PercentLowestTotalValue2Week, EXCLUDED.PercentLowestTotalValue1Month, 
    EXCLUDED. PercentLowestTotalValue2Month, EXCLUDED.PercentLowestTotalValue3Month, 
    EXCLUDED.PercentLowestTotalValue6Month, EXCLUDED. PercentLowestTotalValue9Month, 
    EXCLUDED.PercentLowestTotalValueYTD, EXCLUDED.PercentLowestTotalValue1Year, EXCLUDED. 
    PercentLowestTotalValue52Week, EXCLUDED.PercentLowestTotalMatchValue1Week, 
    EXCLUDED.PercentLowestTotalMatchValue2Week, EXCLUDED. PercentLowestTotalMatchValue1Month, 
    EXCLUDED.PercentLowestTotalMatchValue2Month, EXCLUDED.PercentLowestTotalMatchValue3Month, EXCLUDED. 
    PercentLowestTotalMatchValue6Month, EXCLUDED.PercentLowestTotalMatchValue9Month, 
    EXCLUDED.PercentLowestTotalMatchValue1Year, EXCLUDED. PercentLowestTotalMatchValueYTD, 
    EXCLUDED.PercentLowestTotalMatchValue52Week, EXCLUDED.PercentLowestTotalDealValue1Week, EXCLUDED. 
    PercentLowestTotalDealValue2Week, EXCLUDED.PercentLowestTotalDealValue1Month, 
    EXCLUDED.PercentLowestTotalDealValue2Month, EXCLUDED. PercentLowestTotalDealValue3Month, 
    EXCLUDED.PercentLowestTotalDealValue6Month, EXCLUDED.PercentLowestTotalDealValue9Month, EXCLUDED. 
    PercentLowestTotalDealValue1Year, EXCLUDED.PercentLowestTotalDealValueYTD, 
    EXCLUDED.PercentLowestTotalDealValue52Week, EXCLUDED. AverageDealVolume1Week, 
    EXCLUDED.AverageDealVolume2Week, EXCLUDED.AverageDealVolume1Month, EXCLUDED.AverageDealVolume2Month, 
    EXCLUDED. AverageDealVolume3Month, EXCLUDED.AverageDealVolume6Month, EXCLUDED.AverageDealVolume9Month, 
    EXCLUDED.AverageDealVolume1Year, EXCLUDED. AverageDealVolumeYTD, EXCLUDED.AverageDealVolume52Week, 
    EXCLUDED.AverageDealValue1Week, EXCLUDED.AverageDealValue2Week, EXCLUDED. AverageDealValue1Month, 
    EXCLUDED.AverageDealValue2Month, EXCLUDED.AverageDealValue3Month, EXCLUDED.AverageDealValue6Month, 
    EXCLUDED. AverageDealValue9Month, EXCLUDED.AverageDealValue1Year, EXCLUDED.AverageDealValueYTD, 
    EXCLUDED.AverageDealValue52Week, EXCLUDED. AveragePrice1Week, EXCLUDED.AveragePrice2Week, 
    EXCLUDED.AveragePrice1Month, EXCLUDED.AveragePrice2Month, EXCLUDED.AveragePrice3Month, EXCLUDED. 
    AveragePrice6Month, EXCLUDED.AveragePrice9Month, EXCLUDED.AveragePrice1Year, EXCLUDED.AveragePriceYTD, 
    EXCLUDED.AveragePrice52Week)''',
                          [[item.get("ReturnStockId"), item.get("OrganCode"), item.get("ComGroupCode"),
                            item.get("Ticker"),
                            item.get("TradingDate"),
                            item.get("Status"), item.get("CreateDate"), item.get("UpdateDate"),
                            item.get("HighestPrice1Week"),
                            item.get("HighestPrice2Week"),
                            item.get("HighestPrice1Month"), item.get("HighestPrice2Month"),
                            item.get("HighestPrice3Month"),
                            item.get("HighestPrice6Month"), item.get("HighestPrice9Month"),
                            item.get("HighestPrice1Year"), item.get("HighestPriceYTD"), item.get("HighestPrice52Week"),
                            item.get("LowestPrice1Week"), item.get("LowestPrice2Week"),
                            item.get("LowestPrice1Month"), item.get("LowestPrice2Month"), item.get("LowestPrice3Month"),
                            item.get("LowestPrice6Month"), item.get("LowestPrice9Month"),
                            item.get("LowestPrice1Year"), item.get("LowestPriceYTD"), item.get("LowestPrice52Week"),
                            item.get("PriceChange1Day"), item.get("PriceChange1Week"),
                            item.get("PriceChange2Week"), item.get("PriceChange1Month"), item.get("PriceChange2Month"),
                            item.get("PriceChange3Month"), item.get("PriceChange6Month"),
                            item.get("PriceChange9Month"), item.get("PriceChange1Year"), item.get("PriceChangeYTD"),
                            item.get("PriceChange52Week"), item.get("PercentPriceChange1Day"),
                            item.get("PercentPriceChange1Week"), item.get("PercentPriceChange2Week"),
                            item.get("PercentPriceChange1Month"),
                            item.get("PercentPriceChange2Month"), item.get("PercentPriceChange3Month"),
                            item.get("PercentPriceChange6Month"), item.get("PercentPriceChange9Month"),
                            item.get("PercentPriceChange1Year"), item.get("PercentPriceChangeYTD"),
                            item.get("PercentPriceChange52Week"),
                            item.get("AverageVolume1Week"), item.get("AverageVolume2Week"),
                            item.get("AverageVolume1Month"),
                            item.get("AverageVolume2Month"), item.get("AverageVolume3Month"),
                            item.get("AverageVolume6Month"), item.get("AverageVolume9Month"),
                            item.get("AverageVolume1Year"),
                            item.get("AverageVolumeYTD"), item.get("AverageVolume52Week"),
                            item.get("HighestVolume1Week"), item.get("HighestVolume2Week"),
                            item.get("HighestVolume1Month"),
                            item.get("HighestVolume2Month"), item.get("HighestVolume3Month"),
                            item.get("HighestVolume6Month"), item.get("HighestVolume9Month"),
                            item.get("HighestVolume1Year"),
                            item.get("HighestVolumeYTD"), item.get("HighestVolume52Week"),
                            item.get("LowestVolume1Week"), item.get("LowestVolume2Week"),
                            item.get("LowestVolume1Month"),
                            item.get("LowestVolume2Month"), item.get("LowestVolume3Month"),
                            item.get("LowestVolume6Month"), item.get("LowestVolume9Month"),
                            item.get("LowestVolume1Year"),
                            item.get("LowestVolumeYTD"), item.get("LowestVolume52Week"),
                            item.get("AverageValue1Week"), item.get("AverageValue2Week"),
                            item.get("AverageValue1Month"),
                            item.get("AverageValue2Month"), item.get("AverageValue3Month"),
                            item.get("AverageValue6Month"), item.get("AverageValue9Month"),
                            item.get("AverageValue1Year"),
                            item.get("AverageValueYTD"), item.get("AverageValue52Week"),
                            item.get("HighestValue1Week"), item.get("HighestValue2Week"),
                            item.get("HighestValue1Month"),
                            item.get("HighestValue2Month"), item.get("HighestValue3Month"),
                            item.get("HighestValue6Month"), item.get("HighestValue9Month"),
                            item.get("HighestValue1Year"),
                            item.get("HighestValueYTD"), item.get("HighestValue52Week"),
                            item.get("LowestValue1Week"), item.get("LowestValue2Week"), item.get("LowestValue1Month"),
                            item.get("LowestValue2Month"), item.get("LowestValue3Month"),
                            item.get("LowestValue6Month"), item.get("LowestValue9Month"), item.get("LowestValue1Year"),
                            item.get("LowestValueYTD"), item.get("LowestValue52Week"),
                            item.get("AverageMatchVolume1Week"), item.get("AverageMatchVolume2Week"),
                            item.get("AverageMatchVolume1Month"),
                            item.get("AverageMatchVolume2Month"), item.get("AverageMatchVolume3Month"),
                            item.get("AverageMatchVolume6Month"), item.get("AverageMatchVolume9Month"),
                            item.get("AverageMatchVolume1Year"), item.get("AverageMatchVolumeYTD"),
                            item.get("AverageMatchVolume52Week"),
                            item.get("AverageMatchValue1Week"), item.get("AverageMatchValue2Week"),
                            item.get("AverageMatchValue1Month"),
                            item.get("AverageMatchValue2Month"), item.get("AverageMatchValue3Month"),
                            item.get("AverageMatchValue6Month"), item.get("AverageMatchValue9Month"),
                            item.get("AverageMatchValue1Year"),
                            item.get("AverageMatchValueYTD"), item.get("AverageMatchValue52Week"),
                            item.get("PercentHighestPriceChange1Week"), item.get("PercentHighestPriceChange2Week"),
                            item.get("PercentHighestPriceChange1Month"), item.get("PercentHighestPriceChange2Month"),
                            item.get("PercentHighestPriceChange3Month"),
                            item.get("PercentHighestPriceChange6Month"), item.get("PercentHighestPriceChange9Month"),
                            item.get("PercentHighestPriceChange1Year"), item.get("PercentHighestPriceChangeYTD"),
                            item.get("PercentHighestPriceChange52Week"),
                            item.get("PercentLowestPriceChange1Week"), item.get("PercentLowestPriceChange2Week"),
                            item.get("PercentLowestPriceChange1Month"), item.get("PercentLowestPriceChange2Month"),
                            item.get("PercentLowestPriceChange3Month"),
                            item.get("PercentLowestPriceChange6Month"), item.get("PercentLowestPriceChange9Month"),
                            item.get("PercentLowestPriceChange1Year"), item.get("PercentLowestPriceChangeYTD"),
                            item.get("PercentLowestPriceChange52Week"),
                            item.get("PercentPriceChangeFromHighest"), item.get("PercentPriceChangeFromLowest"),
                            item.get("PercentPriceChangeFTD"), item.get("PercentMatchVolumeChange1Week"),
                            item.get("PercentMatchVolumeChange2Week"),
                            item.get("PercentMatchVolumeChange1Month"), item.get("PercentMatchVolumeChange2Month"),
                            item.get("PercentMatchVolumeChange3Month"), item.get("PercentMatchVolumeChange6Month"),
                            item.get("PercentMatchVolumeChange9Month"),
                            item.get("PercentMatchVolumeChange1Year"), item.get("PercentMatchVolumeChangeYTD"),
                            item.get("PercentMatchVolumeChange52Week"), item.get("VWAP1Day"), item.get("VWAP1Week"),
                            item.get("VWAP2Week"), item.get("VWAP1Month"), item.get("VWAP2Month"),
                            item.get("VWAP3Month"),
                            item.get("VWAP6Month"),
                            item.get("VWAP9Month"), item.get("VWAP1Year"), item.get("VWAPYTD"), item.get("VWAP52Week"),
                            item.get("LocalIndividualBuyTradingMatchVolume"),
                            item.get("LocalIndividualBuyTradingMatchValue"),
                            item.get("ForeignIndividualBuyTradingMatchVolume"),
                            item.get("ForeignIndividualBuyTradingMatchValue"),
                            item.get("LocalInstitutionalBuyTradingMatchVolume"),
                            item.get("LocalInstitutionalBuyTradingMatchValue"),
                            item.get("ForeignInstitutionalBuyTradingMatchVolume"),
                            item.get("ForeignInstitutionalBuyTradingMatchValue"),
                            item.get("LocalIndividualSellTradingMatchVolume"),
                            item.get("LocalIndividualSellTradingMatchValue"),
                            item.get("ForeignIndividualSellTradingMatchVolume"),
                            item.get("ForeignIndividualSellTradingMatchValue"),
                            item.get("LocalInstitutionalSellTradingMatchVolume"),
                            item.get("LocalInstitutionalSellTradingMatchValue"),
                            item.get("ForeignInstitutionalSellTradingMatchVolume"),
                            item.get("ForeignInstitutionalSellTradingMatchValue"),
                            item.get("LocalIndividualBuyTradingDealVolume"),
                            item.get("LocalIndividualBuyTradingDealValue"),
                            item.get("ForeignIndividualBuyTradingDealVolume"),
                            item.get("ForeignIndividualBuyTradingDealValue"),
                            item.get("LocalInstitutionalBuyTradingDealVolume"),
                            item.get("LocalInstitutionalBuyTradingDealValue"),
                            item.get("ForeignInstitutionalBuyTradingDealVolume"),
                            item.get("ForeignInstitutionalBuyTradingDealValue"),
                            item.get("LocalIndividualSellTradingDealVolume"),
                            item.get("LocalIndividualSellTradingDealValue"),
                            item.get("ForeignIndividualSellTradingDealVolume"),
                            item.get("ForeignIndividualSellTradingDealValue"),
                            item.get("LocalInstitutionalSellTradingDealVolume"),
                            item.get("LocalInstitutionalSellTradingDealValue"),
                            item.get("ForeignInstitutionalSellTradingDealVolume"),
                            item.get("ForeignInstitutionalSellTradingDealValue"), item.get("HighestMatchVolume1Week"),
                            item.get("HighestMatchVolume2Week"), item.get("HighestMatchVolume1Month"),
                            item.get("HighestMatchVolume2Month"),
                            item.get("HighestMatchVolume3Month"), item.get("HighestMatchVolume6Month"),
                            item.get("HighestMatchVolume9Month"), item.get("HighestMatchVolume1Year"),
                            item.get("HighestMatchVolumeYTD"),
                            item.get("HighestMatchVolume52Week"), item.get("HighestDealVolume1Week"),
                            item.get("HighestDealVolume2Week"),
                            item.get("HighestDealVolume1Month"), item.get("HighestDealVolume2Month"),
                            item.get("HighestDealVolume3Month"), item.get("HighestDealVolume6Month"),
                            item.get("HighestDealVolume9Month"),
                            item.get("HighestDealVolume1Year"), item.get("HighestDealVolumeYTD"),
                            item.get("HighestDealVolume52Week"), item.get("LowestMatchVolume1Week"),
                            item.get("LowestMatchVolume2Week"),
                            item.get("LowestMatchVolume1Month"), item.get("LowestMatchVolume2Month"),
                            item.get("LowestMatchVolume3Month"), item.get("LowestMatchVolume6Month"),
                            item.get("LowestMatchVolume9Month"),
                            item.get("LowestMatchVolume1Year"), item.get("LowestMatchVolumeYTD"),
                            item.get("LowestMatchVolume52Week"), item.get("LowestDealVolume1Week"),
                            item.get("LowestDealVolume2Week"),
                            item.get("LowestDealVolume1Month"), item.get("LowestDealVolume2Month"),
                            item.get("LowestDealVolume3Month"), item.get("LowestDealVolume6Month"),
                            item.get("LowestDealVolume9Month"),
                            item.get("LowestDealVolume1Year"), item.get("LowestDealVolumeYTD"),
                            item.get("LowestDealVolume52Week"), item.get("HighestMatchValue1Week"),
                            item.get("HighestMatchValue2Week"),
                            item.get("HighestMatchValue1Month"), item.get("HighestMatchValue2Month"),
                            item.get("HighestMatchValue3Month"), item.get("HighestMatchValue6Month"),
                            item.get("HighestMatchValue9Month"),
                            item.get("HighestMatchValue1Year"), item.get("HighestMatchValueYTD"),
                            item.get("HighestMatchValue52Week"), item.get("HighestDealValue1Week"),
                            item.get("HighestDealValue2Week"),
                            item.get("HighestDealValue1Month"), item.get("HighestDealValue2Month"),
                            item.get("HighestDealValue3Month"), item.get("HighestDealValue6Month"),
                            item.get("HighestDealValue9Month"),
                            item.get("HighestDealValue1Year"), item.get("HighestDealValueYTD"),
                            item.get("HighestDealValue52Week"), item.get("LowestMatchValue1Week"),
                            item.get("LowestMatchValue2Week"),
                            item.get("LowestMatchValue1Month"), item.get("LowestMatchValue2Month"),
                            item.get("LowestMatchValue3Month"), item.get("LowestMatchValue6Month"),
                            item.get("LowestMatchValue9Month"),
                            item.get("LowestMatchValue1Year"), item.get("LowestMatchValueYTD"),
                            item.get("LowestMatchValue52Week"), item.get("LowestDealValue1Week"),
                            item.get("LowestDealValue2Week"),
                            item.get("LowestDealValue1Month"), item.get("LowestDealValue2Month"),
                            item.get("LowestDealValue3Month"), item.get("LowestDealValue6Month"),
                            item.get("LowestDealValue9Month"),
                            item.get("LowestDealValue1Year"), item.get("LowestDealValueYTD"),
                            item.get("LowestDealValue52Week"), item.get("PercentHighestTotalVolume1Week"),
                            item.get("PercentHighestTotalVolume2Week"), item.get("PercentHighestTotalVolume1Month"),
                            item.get("PercentHighestTotalVolume2Month"),
                            item.get("PercentHighestTotalVolume3Month"), item.get("PercentHighestTotalVolume6Month"),
                            item.get("PercentHighestTotalVolume9Month"), item.get("PercentHighestTotalVolume1Year"),
                            item.get("PercentHighestTotalVolumeYTD"),
                            item.get("PercentHighestTotalVolume52Week"),
                            item.get("PercentHighestTotalMatchVolume1Week"),
                            item.get("PercentHighestTotalMatchVolume2Week"),
                            item.get("PercentHighestTotalMatchVolume1Month"),
                            item.get("PercentHighestTotalMatchVolume2Month"),
                            item.get("PercentHighestTotalMatchVolume3Month"),
                            item.get("PercentHighestTotalMatchVolume6Month"),
                            item.get("PercentHighestTotalMatchVolume9Month"),
                            item.get("PercentHighestTotalMatchVolume1Year"),
                            item.get("PercentHighestTotalMatchVolumeYTD"),
                            item.get("PercentHighestTotalMatchVolume52Week"),
                            item.get("PercentHighestTotalDealVolume1Week"),
                            item.get("PercentHighestTotalDealVolume2Week"),
                            item.get("PercentHighestTotalDealVolume1Month"),
                            item.get("PercentHighestTotalDealVolume2Month"),
                            item.get("PercentHighestTotalDealVolume3Month"),
                            item.get("PercentHighestTotalDealVolume6Month"),
                            item.get("PercentHighestTotalDealVolume9Month"),
                            item.get("PercentHighestTotalDealVolume1Year"),
                            item.get("PercentHighestTotalDealVolumeYTD"),
                            item.get("PercentHighestTotalDealVolume52Week"), item.get("PercentHighestTotalValue1Week"),
                            item.get("PercentHighestTotalValue2Week"), item.get("PercentHighestTotalValue1Month"),
                            item.get("PercentHighestTotalValue2Month"),
                            item.get("PercentHighestTotalValue3Month"), item.get("PercentHighestTotalValue6Month"),
                            item.get("PercentHighestTotalValue9Month"), item.get("PercentHighestTotalValueYTD"),
                            item.get("PercentHighestTotalValue1Year"),
                            item.get("PercentHighestTotalValue52Week"), item.get("PercentHighestTotalMatchValue1Week"),
                            item.get("PercentHighestTotalMatchValue2Week"),
                            item.get("PercentHighestTotalMatchValue1Month"),
                            item.get("PercentHighestTotalMatchValue2Month"),
                            item.get("PercentHighestTotalMatchValue3Month"),
                            item.get("PercentHighestTotalMatchValue6Month"),
                            item.get("PercentHighestTotalMatchValue9Month"),
                            item.get("PercentHighestTotalMatchValue1Year"),
                            item.get("PercentHighestTotalMatchValueYTD"),
                            item.get("PercentHighestTotalMatchValue52Week"),
                            item.get("PercentHighestTotalDealValue1Week"),
                            item.get("PercentHighestTotalDealValue2Week"),
                            item.get("PercentHighestTotalDealValue1Month"),
                            item.get("PercentHighestTotalDealValue2Month"),
                            item.get("PercentHighestTotalDealValue3Month"),
                            item.get("PercentHighestTotalDealValue6Month"),
                            item.get("PercentHighestTotalDealValue9Month"),
                            item.get("PercentHighestTotalDealValue1Year"),
                            item.get("PercentHighestTotalDealValueYTD"),
                            item.get("PercentHighestTotalDealValue52Week"), item.get("PercentLowestTotalVolume1Week"),
                            item.get("PercentLowestTotalVolume2Week"), item.get("PercentLowestTotalVolume1Month"),
                            item.get("PercentLowestTotalVolume2Month"),
                            item.get("PercentLowestTotalVolume3Month"), item.get("PercentLowestTotalVolume6Month"),
                            item.get("PercentLowestTotalVolume9Month"), item.get("PercentLowestTotalVolume1Year"),
                            item.get("PercentLowestTotalVolumeYTD"),
                            item.get("PercentLowestTotalVolume52Week"), item.get("PercentLowestTotalMatchVolume1Week"),
                            item.get("PercentLowestTotalMatchVolume2Week"),
                            item.get("PercentLowestTotalMatchVolume1Month"),
                            item.get("PercentLowestTotalMatchVolume2Month"),
                            item.get("PercentLowestTotalMatchVolume3Month"),
                            item.get("PercentLowestTotalMatchVolume6Month"),
                            item.get("PercentLowestTotalMatchVolume9Month"),
                            item.get("PercentLowestTotalMatchVolume1Year"),
                            item.get("PercentLowestTotalMatchVolumeYTD"),
                            item.get("PercentLowestTotalMatchVolume52Week"),
                            item.get("PercentLowestTotalDealVolume1Week"),
                            item.get("PercentLowestTotalDealVolume2Week"),
                            item.get("PercentLowestTotalDealVolume1Month"),
                            item.get("PercentLowestTotalDealVolume2Month"),
                            item.get("PercentLowestTotalDealVolume3Month"),
                            item.get("PercentLowestTotalDealVolume6Month"),
                            item.get("PercentLowestTotalDealVolume9Month"),
                            item.get("PercentLowestTotalDealVolume1Year"),
                            item.get("PercentLowestTotalDealVolumeYTD"),
                            item.get("PercentLowestTotalDealVolume52Week"), item.get("PercentLowestTotalValue1Week"),
                            item.get("PercentLowestTotalValue2Week"), item.get("PercentLowestTotalValue1Month"),
                            item.get("PercentLowestTotalValue2Month"),
                            item.get("PercentLowestTotalValue3Month"), item.get("PercentLowestTotalValue6Month"),
                            item.get("PercentLowestTotalValue9Month"), item.get("PercentLowestTotalValueYTD"),
                            item.get("PercentLowestTotalValue1Year"),
                            item.get("PercentLowestTotalValue52Week"), item.get("PercentLowestTotalMatchValue1Week"),
                            item.get("PercentLowestTotalMatchValue2Week"),
                            item.get("PercentLowestTotalMatchValue1Month"),
                            item.get("PercentLowestTotalMatchValue2Month"),
                            item.get("PercentLowestTotalMatchValue3Month"),
                            item.get("PercentLowestTotalMatchValue6Month"),
                            item.get("PercentLowestTotalMatchValue9Month"),
                            item.get("PercentLowestTotalMatchValue1Year"),
                            item.get("PercentLowestTotalMatchValueYTD"),
                            item.get("PercentLowestTotalMatchValue52Week"),
                            item.get("PercentLowestTotalDealValue1Week"),
                            item.get("PercentLowestTotalDealValue2Week"), item.get("PercentLowestTotalDealValue1Month"),
                            item.get("PercentLowestTotalDealValue2Month"),
                            item.get("PercentLowestTotalDealValue3Month"),
                            item.get("PercentLowestTotalDealValue6Month"),
                            item.get("PercentLowestTotalDealValue9Month"), item.get("PercentLowestTotalDealValue1Year"),
                            item.get("PercentLowestTotalDealValueYTD"),
                            item.get("PercentLowestTotalDealValue52Week"), item.get("AverageDealVolume1Week"),
                            item.get("AverageDealVolume2Week"), item.get("AverageDealVolume1Month"),
                            item.get("AverageDealVolume2Month"),
                            item.get("AverageDealVolume3Month"), item.get("AverageDealVolume6Month"),
                            item.get("AverageDealVolume9Month"),
                            item.get("AverageDealVolume1Year"), item.get("AverageDealVolumeYTD"),
                            item.get("AverageDealVolume52Week"), item.get("AverageDealValue1Week"),
                            item.get("AverageDealValue2Week"),
                            item.get("AverageDealValue1Month"), item.get("AverageDealValue2Month"),
                            item.get("AverageDealValue3Month"), item.get("AverageDealValue6Month"),
                            item.get("AverageDealValue9Month"),
                            item.get("AverageDealValue1Year"), item.get("AverageDealValueYTD"),
                            item.get("AverageDealValue52Week"), item.get("AveragePrice1Week"),
                            item.get("AveragePrice2Week"),
                            item.get("AveragePrice1Month"), item.get("AveragePrice2Month"),
                            item.get("AveragePrice3Month"), item.get("AveragePrice6Month"),
                            item.get("AveragePrice9Month"),
                            item.get("AveragePrice1Year"), item.get("AveragePriceYTD"), item.get("AveragePrice52Week")]
                           for item in data])
    print("Done insert data table stx_rto_returnstock / Ratio", datetime.now().strftime('%Y-%m-%d %H:%M:%S'))
    telegram.send(mess=f"Done insert data table stx_rto_returnstock / Ratio / Data size: {len(data)}")


def get_ttm_daily(date_request):
    # Init parameter
    if not date_request:  # Nếu không truyền ngày thì mặc định lấy ngày hiện tại
        date_request = datetime.now().strftime("%Y-%m-%d")
    page_index = 1
    page_size = 100
    url = BASE_URL + "/Ratio/GetRatioTTMDaily?pageIndex=" + str(page_index) \
          + "&pageSize=" + str(page_size) \
          + "&DateType=" + DATE_TYPE + "&fromDate=" + date_request + "&toDate=" + date_request
    print("[get_ttm_daily] get date >> ", url)
    response = service.make_request(url)
    if response is None:
        return

    data = response["Data"]
    paging = response["Paging"]

    while paging.get("NextPage") is not None:
        time.sleep(10)
        print("[get_ttm_daily] NextPage : %s in TotalPage : %s", paging.get("NextPage"), paging.get("TotalPage"))
        url = BASE_URL + "/Ratio/GetRatioTTMDaily?pageIndex=" + str(paging.get("NextPage")) \
              + "&pageSize=" + str(page_size) \
              + "&DateType=" + DATE_TYPE + "&fromDate=" + date_request + "&toDate=" + date_request
        print("[get_ttm_daily] Next page found >> ", url)
        response = service.make_request(url)
        data = data + response["Data"]
        paging = response["Paging"]

        print("[get_ttm_daily] Data size: ", len(data))
    database.execute_many('''INSERT INTO fiin_dtf.stx_rto_ratiottmdaily (RatioTTMDailyId, OrganCode, ComTypeCode, 
    Ticker, YearReport, LengthReport, YearReportCal, LengthReportCal, IndexBasis, TradingDate, TTMType, Status, 
    CreateDate, UpdateDate, RTD1, RTD2, RTD3, RTD4, RTD5, RTD6, RTD7, RTD8, RTD9, RTD10, RTD11, RTD12, RTD13, 
    RTD14, RTD15, RTD16, RTD17, RTD18, RTD19, RTD20, RTD21, RTD22, RTD23, RTD24, RTD25, RTD26, RTD27, RTD28, 
    RTD29, RTD30, RTD31, RTD32, RTD33, RTD34, RTD35, RTD36, RTD37, RTD38, RTD39, RTD40, RTD41, RTD42, RTD43, 
    RTD44, RTD45, RTD46, RTD47, RTD48, RTD49, RTD50, RTD51, RTD52, RTD53, RTD54, RTD55, IntegratedDate) VALUES (
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s) ON CONFLICT ON CONSTRAINT 
    xpkstx_fsc_ratiottmdaily DO UPDATE SET (RatioTTMDailyId, OrganCode, ComTypeCode, Ticker, YearReport, 
    LengthReport, YearReportCal, LengthReportCal, IndexBasis, TradingDate, TTMType, Status, CreateDate, 
    UpdateDate, RTD1, RTD2, RTD3, RTD4, RTD5, RTD6, RTD7, RTD8, RTD9, RTD10, RTD11, RTD12, RTD13, RTD14, RTD15, 
    RTD16, RTD17, RTD18, RTD19, RTD20, RTD21, RTD22, RTD23, RTD24, RTD25, RTD26, RTD27, RTD28, RTD29, RTD30, 
    RTD31, RTD32, RTD33, RTD34, RTD35, RTD36, RTD37, RTD38, RTD39, RTD40, RTD41, RTD42, RTD43, RTD44, RTD45, 
    RTD46, RTD47, RTD48, RTD49, RTD50, RTD51, RTD52, RTD53, RTD54, RTD55, IntegratedDate) = (
    EXCLUDED.RatioTTMDailyId, EXCLUDED.OrganCode, EXCLUDED.ComTypeCode, EXCLUDED.Ticker, EXCLUDED.YearReport, 
    EXCLUDED.LengthReport, EXCLUDED.YearReportCal, EXCLUDED.LengthReportCal, EXCLUDED.IndexBasis, 
    EXCLUDED.TradingDate, EXCLUDED.TTMType, EXCLUDED.Status, EXCLUDED.CreateDate, EXCLUDED.UpdateDate, 
    EXCLUDED.RTD1, EXCLUDED.RTD2, EXCLUDED.RTD3, EXCLUDED.RTD4, EXCLUDED.RTD5, EXCLUDED.RTD6, EXCLUDED.RTD7, 
    EXCLUDED.RTD8, EXCLUDED.RTD9, EXCLUDED.RTD10, EXCLUDED.RTD11, EXCLUDED.RTD12, EXCLUDED.RTD13, EXCLUDED.RTD14, 
    EXCLUDED.RTD15, EXCLUDED.RTD16, EXCLUDED.RTD17, EXCLUDED.RTD18, EXCLUDED.RTD19, EXCLUDED.RTD20, 
    EXCLUDED.RTD21, EXCLUDED.RTD22, EXCLUDED.RTD23, EXCLUDED.RTD24, EXCLUDED.RTD25, EXCLUDED.RTD26, 
    EXCLUDED.RTD27, EXCLUDED.RTD28, EXCLUDED.RTD29, EXCLUDED.RTD30, EXCLUDED.RTD31, EXCLUDED.RTD32, 
    EXCLUDED.RTD33, EXCLUDED.RTD34, EXCLUDED.RTD35, EXCLUDED.RTD36, EXCLUDED.RTD37, EXCLUDED.RTD38, 
    EXCLUDED.RTD39, EXCLUDED.RTD40, EXCLUDED.RTD41, EXCLUDED.RTD42, EXCLUDED.RTD43, EXCLUDED.RTD44, 
    EXCLUDED.RTD45, EXCLUDED.RTD46, EXCLUDED.RTD47, EXCLUDED.RTD48, EXCLUDED.RTD49, EXCLUDED.RTD50, 
    EXCLUDED.RTD51, EXCLUDED.RTD52, EXCLUDED.RTD53, EXCLUDED.RTD54, EXCLUDED.RTD55, EXCLUDED.IntegratedDate)''',
                          [[item.get("RatioTTMDailyId"), item.get("OrganCode"), item.get("ComTypeCode"),
                            item.get("Ticker"),
                            item.get("YearReport"), item.get("LengthReport"), item.get("YearReportCal"),
                            item.get("LengthReportCal"), item.get("IndexBasis"), item.get("TradingDate"),
                            item.get("TTMType"),
                            item.get("Status"), item.get("CreateDate"), item.get("UpdateDate"), item.get("RTD1"),
                            item.get("RTD2"), item.get("RTD3"), item.get("RTD4"), item.get("RTD5"), item.get("RTD6"),
                            item.get("RTD7"), item.get("RTD8"), item.get("RTD9"), item.get("RTD10"), item.get("RTD11"),
                            item.get("RTD12"), item.get("RTD13"), item.get("RTD14"), item.get("RTD15"),
                            item.get("RTD16"),
                            item.get("RTD17"), item.get("RTD18"), item.get("RTD19"), item.get("RTD20"),
                            item.get("RTD21"),
                            item.get("RTD22"), item.get("RTD23"), item.get("RTD24"), item.get("RTD25"),
                            item.get("RTD26"),
                            item.get("RTD27"), item.get("RTD28"), item.get("RTD29"), item.get("RTD30"),
                            item.get("RTD31"),
                            item.get("RTD32"), item.get("RTD33"), item.get("RTD34"), item.get("RTD35"),
                            item.get("RTD36"),
                            item.get("RTD37"), item.get("RTD38"), item.get("RTD39"), item.get("RTD40"),
                            item.get("RTD41"),
                            item.get("RTD42"), item.get("RTD43"), item.get("RTD44"), item.get("RTD45"),
                            item.get("RTD46"),
                            item.get("RTD47"), item.get("RTD48"), item.get("RTD49"), item.get("RTD50"),
                            item.get("RTD51"),
                            item.get("RTD52"), item.get("RTD53"), item.get("RTD54"), item.get("RTD55"),
                            item.get("IntegratedDate")] for item in data])
    print("Done insert data table stx_rto_ratiottmdaily / Ratio", datetime.now().strftime('%Y-%m-%d %H:%M:%S'))
    telegram.send(mess=f"Done insert data table stx_rto_ratiottmdaily / Ratio / Data size: {len(data)}")
