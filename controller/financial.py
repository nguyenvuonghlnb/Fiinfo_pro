import service
import database
import time
import telegram
from datetime import datetime

BASE_URL = "http://df31.fiintek.com"
DATE_TYPE = "updatedate"


def get_balance_sheet(date_request):
    # Init parameter
    if not date_request:  # Nếu không truyền ngày thì mặc định lấy ngày hiện tại
        date_request = datetime.now().strftime("%Y-%m-%d")
    page_index = 1
    page_size = 100
    url = BASE_URL + "/Financial/GetBalanceSheet?pageIndex=" + str(page_index) \
          + "&pageSize=" + str(page_size) \
          + "&DateType=" + DATE_TYPE + "&fromDate=" + date_request + "&toDate=" + date_request
    print("[get_balance_sheet] get date >> ", url)
    response = service.make_request(url)
    if response is None:
        return

    data = response["Data"]
    paging = response["Paging"]

    while paging.get("NextPage") is not None:
        time.sleep(10)
        print("[get_balance_sheet] NextPage : %s in TotalPage : %s", paging.get("NextPage"), paging.get("TotalPage"))
        url = BASE_URL + "/Financial/GetBalanceSheet?pageIndex=" + str(paging.get("NextPage")) \
              + "&pageSize=" + str(page_size) \
              + "&DateType=" + DATE_TYPE + "&fromDate=" + date_request + "&toDate=" + date_request
        print("[get_balance_sheet] Next page found >> ", url)
        response = service.make_request(url)
        data = data + response["Data"]
        paging = response["Paging"]

        print("[get_balance_sheet] Data size: ", len(data))

    database.execute_many('''INSERT INTO fiin_dtf.stx_fsc_balancesheet (BalanceSheetId, OrganCode, ComTypeCode, 
    Ticker, YearReport, LengthReport, LengthSeries, StartDate, EndDate, SourceName, Note, PublicDate, IsAudit, 
    Status, CreateDate, UpdateDate, BSA1, BSA2, BSA3, BSA4, BSA5, BSA6, BSA7, BSA8, BSA9, BSA10, BSA11, BSA12, BSA13, 
    BSA14, BSA15, BSA16, BSA17, BSA18, BSA19, BSA20, BSA21, BSA22, BSA23, BSA24, BSA25, BSA26, BSA27, BSA28, BSA29, 
    BSA30, BSA31, BSA32, BSA33, BSA34, BSA35, BSA36, BSA37, BSA38, BSA39, BSA40, BSA41, BSA42, BSA43, BSA44, BSA45, 
    BSA46, BSA47, BSA48, BSA49, BSA50, BSA51, BSA52, BSA53, BSA54, BSA55, BSA56, BSA57, BSA58, BSA59, BSA60, BSA61, 
    BSA62, BSA63, BSA64, BSA65, BSA66, BSA67, BSA68, BSA69, BSA70, BSA71, BSA72, BSA73, BSA74, BSA75, BSA76, BSA77, 
    BSA78, BSA79, BSA80, BSA81, BSA82, BSA83, BSA84, BSA85, BSA86, BSA87, BSA88, BSA89, BSA90, BSA91, BSA92, BSA93, 
    BSA94, BSA95, BSA96, BSB97, BSB98, BSB99, BSB100, BSB101, BSB102, BSB103, BSB104, BSB105, BSB106, BSB107, BSB108, 
    BSB109, BSB110, BSB111, BSB112, BSB113, BSB114, BSB115, BSB116, BSB117, BSB118, BSB119, BSB120, BSB121, BSB122, 
    BSB123, BSB124, BSB125, BSB126, BSB127, BSB128, BSB129, BSB130, BSB131, BSB132, BSS133, BSS134, BSS135, BSS136, 
    BSS137, BSS138, BSI139, BSI140, BSI141, BSI142, BSI143, BSI144, BSI145, BSI146, BSI147, BSI148, BSI149, BSI150, 
    BSI151, BSI152, BSI153, BSI154, BSI155, BSI156, BSB157, BSB158, BSA159, BSA160, BSA161, BSA162, BSA163, BSA164, 
    BSA165, BSA166, BSA167, BSA168, BSA169, BSA170, BSA171, BSA172, BSA173, BSA174, BSA175, BSA176, BSA177, BSA178, 
    BSB179, BSB180, BSB181, BSB182, BSB183, BSB184, BSB185, BSB186, BSS187, BSA188, BSS189, BSI190, BSI191, BSI192, 
    BSI193, BSI194, BSI195, BSI196, BSI197, BSI198, BSI199, BSI200, BSI201, BSI202, BSI203, BSI204, BSI205, BSI206, 
    BSI207, BSI208, BSA209, BSA210, BSA211, BSS212, BSS213, ReportFormTypeCode, BSS214, BSS215, BSS216, BSS217, 
    BSS218, BSS219, BSS220, BSS221, BSS222, BSS223, BSS224, BSS225, BSS226, BSS227, BSS228, BSS229, BSS230, BSS231, 
    BSS232, BSS233, BSS234, BSS235, BSS236, BSS237, BSS238, BSS239, BSS240, BSS241, BSS242, BSS243, BSS244, BSS245, 
    BSS246, BSS247, BSS248, BSS249, BSS250, BSS251, BSS252, BSS253, BSS254, BSS255, BSS256, BSS257, BSB258, BSB259, 
    BSB260, BSB261, BSB262, BSB263, BSB264, BSB265, BSB266, BSB267, BSB268, BSB269, BSB270, BSB271, BSB272, BSB273, 
    BSB274, BSB275, BSA276, BSA277, BSA278, BSI279, BSI280, BSI281, BSI282, BSI283, BSI284, BSI285, BSI286, 
    BSI287) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s) ON CONFLICT ON CONSTRAINT xpkstx_fsc_balancesheet DO UPDATE SET (BalanceSheetId, OrganCode, ComTypeCode, 
    Ticker, YearReport, LengthReport, LengthSeries, StartDate, EndDate, SourceName, Note, PublicDate, IsAudit, 
    Status, CreateDate, UpdateDate, BSA1, BSA2, BSA3, BSA4, BSA5, BSA6, BSA7, BSA8, BSA9, BSA10, BSA11, BSA12, BSA13, 
    BSA14, BSA15, BSA16, BSA17, BSA18, BSA19, BSA20, BSA21, BSA22, BSA23, BSA24, BSA25, BSA26, BSA27, BSA28, BSA29, 
    BSA30, BSA31, BSA32, BSA33, BSA34, BSA35, BSA36, BSA37, BSA38, BSA39, BSA40, BSA41, BSA42, BSA43, BSA44, BSA45, 
    BSA46, BSA47, BSA48, BSA49, BSA50, BSA51, BSA52, BSA53, BSA54, BSA55, BSA56, BSA57, BSA58, BSA59, BSA60, BSA61, 
    BSA62, BSA63, BSA64, BSA65, BSA66, BSA67, BSA68, BSA69, BSA70, BSA71, BSA72, BSA73, BSA74, BSA75, BSA76, BSA77, 
    BSA78, BSA79, BSA80, BSA81, BSA82, BSA83, BSA84, BSA85, BSA86, BSA87, BSA88, BSA89, BSA90, BSA91, BSA92, BSA93, 
    BSA94, BSA95, BSA96, BSB97, BSB98, BSB99, BSB100, BSB101, BSB102, BSB103, BSB104, BSB105, BSB106, BSB107, BSB108, 
    BSB109, BSB110, BSB111, BSB112, BSB113, BSB114, BSB115, BSB116, BSB117, BSB118, BSB119, BSB120, BSB121, BSB122, 
    BSB123, BSB124, BSB125, BSB126, BSB127, BSB128, BSB129, BSB130, BSB131, BSB132, BSS133, BSS134, BSS135, BSS136, 
    BSS137, BSS138, BSI139, BSI140, BSI141, BSI142, BSI143, BSI144, BSI145, BSI146, BSI147, BSI148, BSI149, BSI150, 
    BSI151, BSI152, BSI153, BSI154, BSI155, BSI156, BSB157, BSB158, BSA159, BSA160, BSA161, BSA162, BSA163, BSA164, 
    BSA165, BSA166, BSA167, BSA168, BSA169, BSA170, BSA171, BSA172, BSA173, BSA174, BSA175, BSA176, BSA177, BSA178, 
    BSB179, BSB180, BSB181, BSB182, BSB183, BSB184, BSB185, BSB186, BSS187, BSA188, BSS189, BSI190, BSI191, BSI192, 
    BSI193, BSI194, BSI195, BSI196, BSI197, BSI198, BSI199, BSI200, BSI201, BSI202, BSI203, BSI204, BSI205, BSI206, 
    BSI207, BSI208, BSA209, BSA210, BSA211, BSS212, BSS213, ReportFormTypeCode, BSS214, BSS215, BSS216, BSS217, 
    BSS218, BSS219, BSS220, BSS221, BSS222, BSS223, BSS224, BSS225, BSS226, BSS227, BSS228, BSS229, BSS230, BSS231, 
    BSS232, BSS233, BSS234, BSS235, BSS236, BSS237, BSS238, BSS239, BSS240, BSS241, BSS242, BSS243, BSS244, BSS245, 
    BSS246, BSS247, BSS248, BSS249, BSS250, BSS251, BSS252, BSS253, BSS254, BSS255, BSS256, BSS257, BSB258, BSB259, 
    BSB260, BSB261, BSB262, BSB263, BSB264, BSB265, BSB266, BSB267, BSB268, BSB269, BSB270, BSB271, BSB272, BSB273, 
    BSB274, BSB275, BSA276, BSA277, BSA278, BSI279, BSI280, BSI281, BSI282, BSI283, BSI284, BSI285, BSI286, 
    BSI287) = (EXCLUDED.BalanceSheetId, EXCLUDED.OrganCode, EXCLUDED.ComTypeCode, EXCLUDED.Ticker, EXCLUDED. 
    YearReport, EXCLUDED.LengthReport, EXCLUDED.LengthSeries, EXCLUDED.StartDate, EXCLUDED.EndDate, 
    EXCLUDED.SourceName, EXCLUDED.Note, EXCLUDED.PublicDate, EXCLUDED.IsAudit, EXCLUDED.Status, EXCLUDED. CreateDate, 
    EXCLUDED.UpdateDate, EXCLUDED.BSA1, EXCLUDED.BSA2, EXCLUDED.BSA3, EXCLUDED.BSA4, EXCLUDED.BSA5, EXCLUDED.BSA6, 
    EXCLUDED.BSA7, EXCLUDED.BSA8, EXCLUDED.BSA9, EXCLUDED.BSA10, EXCLUDED.BSA11, EXCLUDED.BSA12, EXCLUDED.BSA13, 
    EXCLUDED. BSA14, EXCLUDED.BSA15, EXCLUDED.BSA16, EXCLUDED.BSA17, EXCLUDED.BSA18, EXCLUDED.BSA19, EXCLUDED.BSA20, 
    EXCLUDED.BSA21, EXCLUDED.BSA22, EXCLUDED.BSA23, EXCLUDED.BSA24, EXCLUDED.BSA25, EXCLUDED.BSA26, EXCLUDED.BSA27, 
    EXCLUDED.BSA28, EXCLUDED. BSA29, EXCLUDED.BSA30, EXCLUDED.BSA31, EXCLUDED.BSA32, EXCLUDED.BSA33, EXCLUDED.BSA34, 
    EXCLUDED.BSA35, EXCLUDED.BSA36, EXCLUDED.BSA37, EXCLUDED.BSA38, EXCLUDED.BSA39, EXCLUDED.BSA40, EXCLUDED.BSA41, 
    EXCLUDED.BSA42, EXCLUDED.BSA43, EXCLUDED. BSA44, EXCLUDED.BSA45, EXCLUDED.BSA46, EXCLUDED.BSA47, EXCLUDED.BSA48, 
    EXCLUDED.BSA49, EXCLUDED.BSA50, EXCLUDED.BSA51, EXCLUDED.BSA52, EXCLUDED.BSA53, EXCLUDED.BSA54, EXCLUDED.BSA55, 
    EXCLUDED.BSA56, EXCLUDED.BSA57, EXCLUDED.BSA58, EXCLUDED. BSA59, EXCLUDED.BSA60, EXCLUDED.BSA61, EXCLUDED.BSA62, 
    EXCLUDED.BSA63, EXCLUDED.BSA64, EXCLUDED.BSA65, EXCLUDED.BSA66, EXCLUDED.BSA67, EXCLUDED.BSA68, EXCLUDED.BSA69, 
    EXCLUDED.BSA70, EXCLUDED.BSA71, EXCLUDED.BSA72, EXCLUDED.BSA73, EXCLUDED. BSA74, EXCLUDED.BSA75, EXCLUDED.BSA76, 
    EXCLUDED.BSA77, EXCLUDED.BSA78, EXCLUDED.BSA79, EXCLUDED.BSA80, EXCLUDED.BSA81, EXCLUDED.BSA82, EXCLUDED.BSA83, 
    EXCLUDED.BSA84, EXCLUDED.BSA85, EXCLUDED.BSA86, EXCLUDED.BSA87, EXCLUDED.BSA88, EXCLUDED. BSA89, EXCLUDED.BSA90, 
    EXCLUDED.BSA91, EXCLUDED.BSA92, EXCLUDED.BSA93, EXCLUDED.BSA94, EXCLUDED.BSA95, EXCLUDED.BSA96, EXCLUDED.BSB97, 
    EXCLUDED.BSB98, EXCLUDED.BSB99, EXCLUDED.BSB100, EXCLUDED.BSB101, EXCLUDED.BSB102, EXCLUDED.BSB103, 
    EXCLUDED. BSB104, EXCLUDED.BSB105, EXCLUDED.BSB106, EXCLUDED.BSB107, EXCLUDED.BSB108, EXCLUDED.BSB109, 
    EXCLUDED.BSB110, EXCLUDED.BSB111, EXCLUDED.BSB112, EXCLUDED.BSB113, EXCLUDED.BSB114, EXCLUDED.BSB115, 
    EXCLUDED.BSB116, EXCLUDED. BSB117, EXCLUDED.BSB118, EXCLUDED.BSB119, EXCLUDED.BSB120, EXCLUDED.BSB121, 
    EXCLUDED.BSB122, EXCLUDED.BSB123, EXCLUDED.BSB124, EXCLUDED.BSB125, EXCLUDED.BSB126, EXCLUDED.BSB127, 
    EXCLUDED.BSB128, EXCLUDED.BSB129, EXCLUDED. BSB130, EXCLUDED.BSB131, EXCLUDED.BSB132, EXCLUDED.BSS133, 
    EXCLUDED.BSS134, EXCLUDED.BSS135, EXCLUDED.BSS136, EXCLUDED.BSS137, EXCLUDED.BSS138, EXCLUDED.BSI139, 
    EXCLUDED.BSI140, EXCLUDED.BSI141, EXCLUDED.BSI142, EXCLUDED. BSI143, EXCLUDED.BSI144, EXCLUDED.BSI145, 
    EXCLUDED.BSI146, EXCLUDED.BSI147, EXCLUDED.BSI148, EXCLUDED.BSI149, EXCLUDED.BSI150, EXCLUDED.BSI151, 
    EXCLUDED.BSI152, EXCLUDED.BSI153, EXCLUDED.BSI154, EXCLUDED.BSI155, EXCLUDED. BSI156, EXCLUDED.BSB157, 
    EXCLUDED.BSB158, EXCLUDED.BSA159, EXCLUDED.BSA160, EXCLUDED.BSA161, EXCLUDED.BSA162, EXCLUDED.BSA163, 
    EXCLUDED.BSA164, EXCLUDED.BSA165, EXCLUDED.BSA166, EXCLUDED.BSA167, EXCLUDED.BSA168, EXCLUDED. BSA169, 
    EXCLUDED.BSA170, EXCLUDED.BSA171, EXCLUDED.BSA172, EXCLUDED.BSA173, EXCLUDED.BSA174, EXCLUDED.BSA175, 
    EXCLUDED.BSA176, EXCLUDED.BSA177, EXCLUDED.BSA178, EXCLUDED.BSB179, EXCLUDED.BSB180, EXCLUDED.BSB181, 
    EXCLUDED. BSB182, EXCLUDED.BSB183, EXCLUDED.BSB184, EXCLUDED.BSB185, EXCLUDED.BSB186, EXCLUDED.BSS187, 
    EXCLUDED.BSA188, EXCLUDED.BSS189, EXCLUDED.BSI190, EXCLUDED.BSI191, EXCLUDED.BSI192, EXCLUDED.BSI193, 
    EXCLUDED.BSI194, EXCLUDED. BSI195, EXCLUDED.BSI196, EXCLUDED.BSI197, EXCLUDED.BSI198, EXCLUDED.BSI199, 
    EXCLUDED.BSI200, EXCLUDED.BSI201, EXCLUDED.BSI202, EXCLUDED.BSI203, EXCLUDED.BSI204, EXCLUDED.BSI205, 
    EXCLUDED.BSI206, EXCLUDED.BSI207, EXCLUDED. BSI208, EXCLUDED.BSA209, EXCLUDED.BSA210, EXCLUDED.BSA211, 
    EXCLUDED.BSS212, EXCLUDED.BSS213, EXCLUDED.ReportFormTypeCode, EXCLUDED.BSS214, EXCLUDED.BSS215, EXCLUDED.BSS216, 
    EXCLUDED.BSS217, EXCLUDED.BSS218, EXCLUDED. BSS219, EXCLUDED.BSS220, EXCLUDED.BSS221, EXCLUDED.BSS222, 
    EXCLUDED.BSS223, EXCLUDED.BSS224, EXCLUDED.BSS225, EXCLUDED.BSS226, EXCLUDED.BSS227, EXCLUDED.BSS228, 
    EXCLUDED.BSS229, EXCLUDED.BSS230, EXCLUDED.BSS231, EXCLUDED. BSS232, EXCLUDED.BSS233, EXCLUDED.BSS234, 
    EXCLUDED.BSS235, EXCLUDED.BSS236, EXCLUDED.BSS237, EXCLUDED.BSS238, EXCLUDED.BSS239, EXCLUDED.BSS240, 
    EXCLUDED.BSS241, EXCLUDED.BSS242, EXCLUDED.BSS243, EXCLUDED.BSS244, EXCLUDED. BSS245, EXCLUDED.BSS246, 
    EXCLUDED.BSS247, EXCLUDED.BSS248, EXCLUDED.BSS249, EXCLUDED.BSS250, EXCLUDED.BSS251, EXCLUDED.BSS252, 
    EXCLUDED.BSS253, EXCLUDED.BSS254, EXCLUDED.BSS255, EXCLUDED.BSS256, EXCLUDED.BSS257, EXCLUDED. BSB258, 
    EXCLUDED.BSB259, EXCLUDED.BSB260, EXCLUDED.BSB261, EXCLUDED.BSB262, EXCLUDED.BSB263, EXCLUDED.BSB264, 
    EXCLUDED.BSB265, EXCLUDED.BSB266, EXCLUDED.BSB267, EXCLUDED.BSB268, EXCLUDED.BSB269, EXCLUDED.BSB270, 
    EXCLUDED. BSB271, EXCLUDED.BSB272, EXCLUDED.BSB273, EXCLUDED.BSB274, EXCLUDED.BSB275, EXCLUDED.BSA276, 
    EXCLUDED.BSA277, EXCLUDED.BSA278, EXCLUDED.BSI279, EXCLUDED.BSI280, EXCLUDED.BSI281, EXCLUDED.BSI282, 
    EXCLUDED.BSI283, EXCLUDED. BSI284, EXCLUDED.BSI285, EXCLUDED.BSI286, EXCLUDED.BSI287)''',
                          [[item.get("BalanceSheetId"), item.get("OrganCode"), item.get("ComTypeCode"),
                            item.get("Ticker"),
                            item.get("YearReport"),
                            item.get("LengthReport"), item.get("LengthSeries"), item.get("StartDate"),
                            item.get("EndDate"), item.get("SourceName"), item.get("Note"), item.get("PublicDate"),
                            item.get("IsAudit"),
                            item.get("Status"), item.get("CreateDate"), item.get("UpdateDate"),
                            item.get("BSA1"), item.get("BSA2"), item.get("BSA3"), item.get("BSA4"), item.get("BSA5"),
                            item.get("BSA6"), item.get("BSA7"),
                            item.get("BSA8"), item.get("BSA9"),
                            item.get("BSA10"), item.get("BSA11"), item.get("BSA12"), item.get("BSA13"),
                            item.get("BSA14"), item.get("BSA15"),
                            item.get("BSA16"), item.get("BSA17"), item.get("BSA18"),
                            item.get("BSA19"), item.get("BSA20"), item.get("BSA21"), item.get("BSA22"),
                            item.get("BSA23"), item.get("BSA24"),
                            item.get("BSA25"), item.get("BSA26"), item.get("BSA27"),
                            item.get("BSA28"), item.get("BSA29"), item.get("BSA30"), item.get("BSA31"),
                            item.get("BSA32"), item.get("BSA33"),
                            item.get("BSA34"), item.get("BSA35"), item.get("BSA36"),
                            item.get("BSA37"), item.get("BSA38"), item.get("BSA39"), item.get("BSA40"),
                            item.get("BSA41"), item.get("BSA42"),
                            item.get("BSA43"), item.get("BSA44"), item.get("BSA45"),
                            item.get("BSA46"), item.get("BSA47"), item.get("BSA48"), item.get("BSA49"),
                            item.get("BSA50"), item.get("BSA51"),
                            item.get("BSA52"), item.get("BSA53"), item.get("BSA54"),
                            item.get("BSA55"), item.get("BSA56"), item.get("BSA57"), item.get("BSA58"),
                            item.get("BSA59"), item.get("BSA60"),
                            item.get("BSA61"), item.get("BSA62"), item.get("BSA63"),
                            item.get("BSA64"), item.get("BSA65"), item.get("BSA66"), item.get("BSA67"),
                            item.get("BSA68"), item.get("BSA69"),
                            item.get("BSA70"), item.get("BSA71"), item.get("BSA72"),
                            item.get("BSA73"), item.get("BSA74"), item.get("BSA75"), item.get("BSA76"),
                            item.get("BSA77"), item.get("BSA78"),
                            item.get("BSA79"), item.get("BSA80"), item.get("BSA81"),
                            item.get("BSA82"), item.get("BSA83"), item.get("BSA84"), item.get("BSA85"),
                            item.get("BSA86"), item.get("BSA87"),
                            item.get("BSA88"), item.get("BSA89"), item.get("BSA90"),
                            item.get("BSA91"), item.get("BSA92"), item.get("BSA93"), item.get("BSA94"),
                            item.get("BSA95"), item.get("BSA96"),
                            item.get("BSB97"), item.get("BSB98"), item.get("BSB99"),
                            item.get("BSB100"), item.get("BSB101"), item.get("BSB102"), item.get("BSB103"),
                            item.get("BSB104"), item.get("BSB105"),
                            item.get("BSB106"), item.get("BSB107"), item.get("BSB108"),
                            item.get("BSB109"), item.get("BSB110"), item.get("BSB111"), item.get("BSB112"),
                            item.get("BSB113"), item.get("BSB114"),
                            item.get("BSB115"), item.get("BSB116"), item.get("BSB117"),
                            item.get("BSB118"), item.get("BSB119"), item.get("BSB120"), item.get("BSB121"),
                            item.get("BSB122"), item.get("BSB123"),
                            item.get("BSB124"), item.get("BSB125"), item.get("BSB126"),
                            item.get("BSB127"), item.get("BSB128"), item.get("BSB129"), item.get("BSB130"),
                            item.get("BSB131"), item.get("BSB132"),
                            item.get("BSS133"), item.get("BSS134"), item.get("BSS135"),
                            item.get("BSS136"), item.get("BSS137"), item.get("BSS138"), item.get("BSI139"),
                            item.get("BSI140"), item.get("BSI141"),
                            item.get("BSI142"), item.get("BSI143"), item.get("BSI144"),
                            item.get("BSI145"), item.get("BSI146"), item.get("BSI147"), item.get("BSI148"),
                            item.get("BSI149"), item.get("BSI150"),
                            item.get("BSI151"), item.get("BSI152"), item.get("BSI153"),
                            item.get("BSI154"), item.get("BSI155"), item.get("BSI156"), item.get("BSB157"),
                            item.get("BSB158"), item.get("BSA159"),
                            item.get("BSA160"), item.get("BSA161"), item.get("BSA162"),
                            item.get("BSA163"), item.get("BSA164"), item.get("BSA165"), item.get("BSA166"),
                            item.get("BSA167"), item.get("BSA168"),
                            item.get("BSA169"), item.get("BSA170"), item.get("BSA171"),
                            item.get("BSA172"), item.get("BSA173"), item.get("BSA174"), item.get("BSA175"),
                            item.get("BSA176"), item.get("BSA177"),
                            item.get("BSA178"), item.get("BSB179"), item.get("BSB180"),
                            item.get("BSB181"), item.get("BSB182"), item.get("BSB183"), item.get("BSB184"),
                            item.get("BSB185"), item.get("BSB186"),
                            item.get("BSS187"), item.get("BSA188"), item.get("BSS189"),
                            item.get("BSI190"), item.get("BSI191"), item.get("BSI192"), item.get("BSI193"),
                            item.get("BSI194"), item.get("BSI195"),
                            item.get("BSI196"), item.get("BSI197"), item.get("BSI198"),
                            item.get("BSI199"), item.get("BSI200"), item.get("BSI201"), item.get("BSI202"),
                            item.get("BSI203"), item.get("BSI204"),
                            item.get("BSI205"), item.get("BSI206"), item.get("BSI207"),
                            item.get("BSI208"), item.get("BSA209"), item.get("BSA210"), item.get("BSA211"),
                            item.get("BSS212"), item.get("BSS213"),
                            item.get("ReportFormTypeCode"), item.get("BSS214"), item.get("BSS215"),
                            item.get("BSS216"), item.get("BSS217"), item.get("BSS218"), item.get("BSS219"),
                            item.get("BSS220"), item.get("BSS221"),
                            item.get("BSS222"), item.get("BSS223"), item.get("BSS224"),
                            item.get("BSS225"), item.get("BSS226"), item.get("BSS227"), item.get("BSS228"),
                            item.get("BSS229"), item.get("BSS230"),
                            item.get("BSS231"), item.get("BSS232"), item.get("BSS233"),
                            item.get("BSS234"), item.get("BSS235"), item.get("BSS236"), item.get("BSS237"),
                            item.get("BSS238"), item.get("BSS239"),
                            item.get("BSS240"), item.get("BSS241"), item.get("BSS242"),
                            item.get("BSS243"), item.get("BSS244"), item.get("BSS245"), item.get("BSS246"),
                            item.get("BSS247"), item.get("BSS248"),
                            item.get("BSS249"), item.get("BSS250"), item.get("BSS251"),
                            item.get("BSS252"), item.get("BSS253"), item.get("BSS254"), item.get("BSS255"),
                            item.get("BSS256"), item.get("BSS257"),
                            item.get("BSB258"), item.get("BSB259"), item.get("BSB260"),
                            item.get("BSB261"), item.get("BSB262"), item.get("BSB263"), item.get("BSB264"),
                            item.get("BSB265"), item.get("BSB266"),
                            item.get("BSB267"), item.get("BSB268"), item.get("BSB269"),
                            item.get("BSB270"), item.get("BSB271"), item.get("BSB272"), item.get("BSB273"),
                            item.get("BSB274"), item.get("BSB275"),
                            item.get("BSA276"), item.get("BSA277"), item.get("BSA278"),
                            item.get("BSI279"), item.get("BSI280"), item.get("BSI281"), item.get("BSI282"),
                            item.get("BSI283"), item.get("BSI284"),
                            item.get("BSI285"), item.get("BSI286"), item.get("BSI287")] for item in data])
    print("Done insert data table stx_fsc_balancesheet / Financial", datetime.now().strftime('%Y-%m-%d %H:%M:%S'))
    telegram.send(mess=f"Done insert data table stx_fsc_balancesheet / Financial / Data size: {len(data)}")


def get_income_statement(date_request):
    # Init parameter
    if not date_request:  # Nếu không truyền ngày thì mặc định lấy ngày hiện tại
        date_request = datetime.now().strftime("%Y-%m-%d")
    page_index = 1
    page_size = 100
    url = BASE_URL + "/Financial/GetIncomeStatement?pageIndex=" + str(page_index) \
          + "&pageSize=" + str(page_size) \
          + "&DateType=" + DATE_TYPE + "&fromDate=" + date_request + "&toDate=" + date_request
    print("[get_income_statement] get date >> ", url)
    response = service.make_request(url)
    if response is None:
        return

    data = response["Data"]
    paging = response["Paging"]

    while paging.get("NextPage") is not None:
        time.sleep(10)
        print("[get_income_statement] NextPage : %s in TotalPage : %s", paging.get("NextPage"), paging.get("TotalPage"))
        url = BASE_URL + "/Financial/GetIncomeStatement?pageIndex=" + str(paging.get("NextPage")) \
              + "&pageSize=" + str(page_size) \
              + "&DateType=" + DATE_TYPE + "&fromDate=" + date_request + "&toDate=" + date_request
        print("[get_income_statement] Next page found >> ", url)
        response = service.make_request(url)
        data = data + response["Data"]
        paging = response["Paging"]

        print("[get_income_statement] Data size: ", len(data))

    database.execute_many('''INSERT INTO fiin_dtf.stx_fsc_incomestatement (IncomeStatementId, OrganCode, ComTypeCode, 
    Ticker, YearReport, LengthReport, LengthSeries, StartDate, EndDate, SourceName, Note, PublicDate, IsAudit, 
    Status, CreateDate, UpdateDate, ISA1, ISA2, ISA3, ISA4, ISA5, ISA6, ISA7, ISA8, ISA9, ISA10, ISA11, ISA12, 
    ISA13, ISA14, ISA15, ISA16, ISA17, ISA18, ISA19, ISA20, ISA21, ISA22, ISA23, ISA24, ISB25, ISB26, ISB27, 
    ISB28, ISB29, ISB30, ISB31, ISB32, ISB33, ISB34, ISB35, ISB36, ISB37, ISB38, ISB39, ISB40, ISB41, ISS42, 
    ISS43, ISS44, ISS45, ISS46, ISS47, ISS48, ISS49, ISS50, ISI51, ISI52, ISI53, ISI54, ISI55, ISI56, ISI57, 
    ISI58, ISI59, ISI60, ISI61, ISI62, ISI63, ISI64, ISI65, ISI66, ISI67, ISI68, ISI69, ISI70, ISI71, ISI72, 
    ISI73, ISI74, ISI75, ISI76, ISI77, ISI78, ISI79, ISI80, ISI81, ISI82, ISI83, ISI84, ISI85, ISI86, ISI87, 
    ISI88, ISI89, ISI90, ISI91, ISI92, ISI93, ISI94, ISI95, ISI96, ISI97, ISI98, ISI99, ISI100, ISI101, ISA102, 
    ISI103, ISI104, ISI105, ISI106, ISI107, ISI108, ISI109, ISI110, ISI111, ISI112, ISI113, ISI114, 
    ReportFormTypeCode, ISS115, ISS116, ISS117, ISS118, ISS119, ISS120, ISS121, ISS122, ISS123, ISS124, ISS125, 
    ISS126, ISS127, ISS128, ISS129, ISS130, ISS131, ISS132, ISS133, ISS134, ISS135, ISS136, ISS137, ISS138, 
    ISS139, ISS140, ISS141, ISS142, ISS143, ISS144, ISS145, ISS146, ISS147, ISS148, ISS149, ISS150, ISS151, 
    ISS152, ISS153, ISS154, ISS155, ISS156, ISS157, ISS158, ISS159, ISS160, ISS161, ISS162, ISS163, ISS164, 
    ISS165, ISS166, ISS167, ISI168, ISI169, ISI170, ISI171, ISI172, ISI173, ISS174, ISI175, ISI176, ISI177, 
    ISI178, ISI179, ISI180) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, 
    %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s) ON CONFLICT ON CONSTRAINT 
    xpkstx_fsc_incomestatement DO UPDATE SET (IncomeStatementId, OrganCode, ComTypeCode, Ticker, YearReport, 
    LengthReport, LengthSeries, StartDate, EndDate, SourceName, Note, PublicDate, IsAudit, Status, CreateDate, 
    UpdateDate, ISA1, ISA2, ISA3, ISA4, ISA5, ISA6, ISA7, ISA8, ISA9, ISA10, ISA11, ISA12, ISA13, ISA14, ISA15, 
    ISA16, ISA17, ISA18, ISA19, ISA20, ISA21, ISA22, ISA23, ISA24, ISB25, ISB26, ISB27, ISB28, ISB29, ISB30, 
    ISB31, ISB32, ISB33, ISB34, ISB35, ISB36, ISB37, ISB38, ISB39, ISB40, ISB41, ISS42, ISS43, ISS44, ISS45, 
    ISS46, ISS47, ISS48, ISS49, ISS50, ISI51, ISI52, ISI53, ISI54, ISI55, ISI56, ISI57, ISI58, ISI59, ISI60, 
    ISI61, ISI62, ISI63, ISI64, ISI65, ISI66, ISI67, ISI68, ISI69, ISI70, ISI71, ISI72, ISI73, ISI74, ISI75, 
    ISI76, ISI77, ISI78, ISI79, ISI80, ISI81, ISI82, ISI83, ISI84, ISI85, ISI86, ISI87, ISI88, ISI89, ISI90, 
    ISI91, ISI92, ISI93, ISI94, ISI95, ISI96, ISI97, ISI98, ISI99, ISI100, ISI101, ISA102, ISI103, ISI104, 
    ISI105, ISI106, ISI107, ISI108, ISI109, ISI110, ISI111, ISI112, ISI113, ISI114, ReportFormTypeCode, ISS115, 
    ISS116, ISS117, ISS118, ISS119, ISS120, ISS121, ISS122, ISS123, ISS124, ISS125, ISS126, ISS127, ISS128, 
    ISS129, ISS130, ISS131, ISS132, ISS133, ISS134, ISS135, ISS136, ISS137, ISS138, ISS139, ISS140, ISS141, 
    ISS142, ISS143, ISS144, ISS145, ISS146, ISS147, ISS148, ISS149, ISS150, ISS151, ISS152, ISS153, ISS154, 
    ISS155, ISS156, ISS157, ISS158, ISS159, ISS160, ISS161, ISS162, ISS163, ISS164, ISS165, ISS166, ISS167, 
    ISI168, ISI169, ISI170, ISI171, ISI172, ISI173, ISS174, ISI175, ISI176, ISI177, ISI178, ISI179, ISI180) = (
    EXCLUDED.IncomeStatementId, EXCLUDED.OrganCode, EXCLUDED.ComTypeCode, EXCLUDED. Ticker, EXCLUDED.YearReport, 
    EXCLUDED.LengthReport, EXCLUDED.LengthSeries, EXCLUDED.StartDate, EXCLUDED.EndDate, EXCLUDED.SourceName, 
    EXCLUDED.Note, EXCLUDED.PublicDate, EXCLUDED.IsAudit, EXCLUDED. Status, EXCLUDED.CreateDate, 
    EXCLUDED.UpdateDate, EXCLUDED.ISA1, EXCLUDED.ISA2, EXCLUDED.ISA3, EXCLUDED.ISA4, EXCLUDED.ISA5, 
    EXCLUDED.ISA6, EXCLUDED.ISA7, EXCLUDED.ISA8, EXCLUDED.ISA9, EXCLUDED.ISA10, EXCLUDED.ISA11, EXCLUDED.ISA12, 
    EXCLUDED. ISA13, EXCLUDED.ISA14, EXCLUDED.ISA15, EXCLUDED.ISA16, EXCLUDED.ISA17, EXCLUDED.ISA18, 
    EXCLUDED.ISA19, EXCLUDED.ISA20, EXCLUDED.ISA21, EXCLUDED.ISA22, EXCLUDED.ISA23, EXCLUDED.ISA24, 
    EXCLUDED.ISB25, EXCLUDED.ISB26, EXCLUDED.ISB27, EXCLUDED. ISB28, EXCLUDED.ISB29, EXCLUDED.ISB30, 
    EXCLUDED.ISB31, EXCLUDED.ISB32, EXCLUDED.ISB33, EXCLUDED.ISB34, EXCLUDED.ISB35, EXCLUDED.ISB36, 
    EXCLUDED.ISB37, EXCLUDED.ISB38, EXCLUDED.ISB39, EXCLUDED.ISB40, EXCLUDED.ISB41, EXCLUDED.ISS42, 
    EXCLUDED. ISS43, EXCLUDED.ISS44, EXCLUDED.ISS45, EXCLUDED.ISS46, EXCLUDED.ISS47, EXCLUDED.ISS48, 
    EXCLUDED.ISS49, EXCLUDED.ISS50, EXCLUDED.ISI51, EXCLUDED.ISI52, EXCLUDED.ISI53, EXCLUDED.ISI54, 
    EXCLUDED.ISI55, EXCLUDED.ISI56, EXCLUDED.ISI57, EXCLUDED. ISI58, EXCLUDED.ISI59, EXCLUDED.ISI60, 
    EXCLUDED.ISI61, EXCLUDED.ISI62, EXCLUDED.ISI63, EXCLUDED.ISI64, EXCLUDED.ISI65, EXCLUDED.ISI66, 
    EXCLUDED.ISI67, EXCLUDED.ISI68, EXCLUDED.ISI69, EXCLUDED.ISI70, EXCLUDED.ISI71, EXCLUDED.ISI72, 
    EXCLUDED. ISI73, EXCLUDED.ISI74, EXCLUDED.ISI75, EXCLUDED.ISI76, EXCLUDED.ISI77, EXCLUDED.ISI78, 
    EXCLUDED.ISI79, EXCLUDED.ISI80, EXCLUDED.ISI81, EXCLUDED.ISI82, EXCLUDED.ISI83, EXCLUDED.ISI84, 
    EXCLUDED.ISI85, EXCLUDED.ISI86, EXCLUDED.ISI87, EXCLUDED. ISI88, EXCLUDED.ISI89, EXCLUDED.ISI90, 
    EXCLUDED.ISI91, EXCLUDED.ISI92, EXCLUDED.ISI93, EXCLUDED.ISI94, EXCLUDED.ISI95, EXCLUDED.ISI96, 
    EXCLUDED.ISI97, EXCLUDED.ISI98, EXCLUDED.ISI99, EXCLUDED.ISI100, EXCLUDED.ISI101, EXCLUDED.ISA102, 
    EXCLUDED. ISI103, EXCLUDED.ISI104, EXCLUDED.ISI105, EXCLUDED.ISI106, EXCLUDED.ISI107, EXCLUDED.ISI108, 
    EXCLUDED.ISI109, EXCLUDED.ISI110, EXCLUDED.ISI111, EXCLUDED.ISI112, EXCLUDED.ISI113, EXCLUDED.ISI114, 
    EXCLUDED. ReportFormTypeCode, EXCLUDED.ISS115, EXCLUDED.ISS116, EXCLUDED.ISS117, EXCLUDED.ISS118, 
    EXCLUDED.ISS119, EXCLUDED.ISS120, EXCLUDED.ISS121, EXCLUDED.ISS122, EXCLUDED.ISS123, EXCLUDED.ISS124, 
    EXCLUDED.ISS125, EXCLUDED. ISS126, EXCLUDED.ISS127, EXCLUDED.ISS128, EXCLUDED.ISS129, EXCLUDED.ISS130, 
    EXCLUDED.ISS131, EXCLUDED.ISS132, EXCLUDED.ISS133, EXCLUDED.ISS134, EXCLUDED.ISS135, EXCLUDED.ISS136, 
    EXCLUDED.ISS137, EXCLUDED.ISS138, EXCLUDED. ISS139, EXCLUDED.ISS140, EXCLUDED.ISS141, EXCLUDED.ISS142, 
    EXCLUDED.ISS143, EXCLUDED.ISS144, EXCLUDED.ISS145, EXCLUDED.ISS146, EXCLUDED.ISS147, EXCLUDED.ISS148, 
    EXCLUDED.ISS149, EXCLUDED.ISS150, EXCLUDED.ISS151, EXCLUDED. ISS152, EXCLUDED.ISS153, EXCLUDED.ISS154, 
    EXCLUDED.ISS155, EXCLUDED.ISS156, EXCLUDED.ISS157, EXCLUDED.ISS158, EXCLUDED.ISS159, EXCLUDED.ISS160, 
    EXCLUDED.ISS161, EXCLUDED.ISS162, EXCLUDED.ISS163, EXCLUDED.ISS164, EXCLUDED. ISS165, EXCLUDED.ISS166, 
    EXCLUDED.ISS167, EXCLUDED.ISI168, EXCLUDED.ISI169, EXCLUDED.ISI170, EXCLUDED.ISI171, EXCLUDED.ISI172, 
    EXCLUDED.ISI173, EXCLUDED.ISS174, EXCLUDED.ISI175, EXCLUDED.ISI176, EXCLUDED.ISI177, EXCLUDED. ISI178, 
    EXCLUDED.ISI179, EXCLUDED.ISI180)''',
                          [[item.get("IncomeStatementId"), item.get("OrganCode"), item.get("ComTypeCode"),
                            item.get("Ticker"),
                            item.get("YearReport"),
                            item.get("LengthReport"), item.get("LengthSeries"), item.get("StartDate"),
                            item.get("EndDate"), item.get("SourceName"), item.get("Note"), item.get("PublicDate"),
                            item.get("IsAudit"),
                            item.get("Status"), item.get("CreateDate"), item.get("UpdateDate"),
                            item.get("ISA1"), item.get("ISA2"), item.get("ISA3"), item.get("ISA4"), item.get("ISA5"),
                            item.get("ISA6"), item.get("ISA7"),
                            item.get("ISA8"), item.get("ISA9"),
                            item.get("ISA10"), item.get("ISA11"), item.get("ISA12"), item.get("ISA13"),
                            item.get("ISA14"), item.get("ISA15"),
                            item.get("ISA16"), item.get("ISA17"), item.get("ISA18"),
                            item.get("ISA19"), item.get("ISA20"), item.get("ISA21"), item.get("ISA22"),
                            item.get("ISA23"), item.get("ISA24"),
                            item.get("ISB25"), item.get("ISB26"), item.get("ISB27"),
                            item.get("ISB28"), item.get("ISB29"), item.get("ISB30"), item.get("ISB31"),
                            item.get("ISB32"), item.get("ISB33"),
                            item.get("ISB34"), item.get("ISB35"), item.get("ISB36"),
                            item.get("ISB37"), item.get("ISB38"), item.get("ISB39"), item.get("ISB40"),
                            item.get("ISB41"), item.get("ISS42"),
                            item.get("ISS43"), item.get("ISS44"), item.get("ISS45"),
                            item.get("ISS46"), item.get("ISS47"), item.get("ISS48"), item.get("ISS49"),
                            item.get("ISS50"), item.get("ISI51"),
                            item.get("ISI52"), item.get("ISI53"), item.get("ISI54"),
                            item.get("ISI55"), item.get("ISI56"), item.get("ISI57"), item.get("ISI58"),
                            item.get("ISI59"), item.get("ISI60"),
                            item.get("ISI61"), item.get("ISI62"), item.get("ISI63"),
                            item.get("ISI64"), item.get("ISI65"), item.get("ISI66"), item.get("ISI67"),
                            item.get("ISI68"), item.get("ISI69"),
                            item.get("ISI70"), item.get("ISI71"), item.get("ISI72"),
                            item.get("ISI73"), item.get("ISI74"), item.get("ISI75"), item.get("ISI76"),
                            item.get("ISI77"), item.get("ISI78"),
                            item.get("ISI79"), item.get("ISI80"), item.get("ISI81"),
                            item.get("ISI82"), item.get("ISI83"), item.get("ISI84"), item.get("ISI85"),
                            item.get("ISI86"), item.get("ISI87"),
                            item.get("ISI88"), item.get("ISI89"), item.get("ISI90"),
                            item.get("ISI91"), item.get("ISI92"), item.get("ISI93"), item.get("ISI94"),
                            item.get("ISI95"), item.get("ISI96"),
                            item.get("ISI97"), item.get("ISI98"), item.get("ISI99"),
                            item.get("ISI100"), item.get("ISI101"), item.get("ISA102"), item.get("ISI103"),
                            item.get("ISI104"), item.get("ISI105"),
                            item.get("ISI106"), item.get("ISI107"), item.get("ISI108"),
                            item.get("ISI109"), item.get("ISI110"), item.get("ISI111"), item.get("ISI112"),
                            item.get("ISI113"), item.get("ISI114"),
                            item.get("ReportFormTypeCode"),
                            item.get("ISS115"), item.get("ISS116"), item.get("ISS117"),
                            item.get("ISS118"), item.get("ISS119"), item.get("ISS120"), item.get("ISS121"),
                            item.get("ISS122"), item.get("ISS123"),
                            item.get("ISS124"), item.get("ISS125"), item.get("ISS126"),
                            item.get("ISS127"), item.get("ISS128"), item.get("ISS129"), item.get("ISS130"),
                            item.get("ISS131"), item.get("ISS132"),
                            item.get("ISS133"), item.get("ISS134"), item.get("ISS135"),
                            item.get("ISS136"), item.get("ISS137"), item.get("ISS138"), item.get("ISS139"),
                            item.get("ISS140"), item.get("ISS141"),
                            item.get("ISS142"), item.get("ISS143"), item.get("ISS144"),
                            item.get("ISS145"), item.get("ISS146"), item.get("ISS147"), item.get("ISS148"),
                            item.get("ISS149"), item.get("ISS150"),
                            item.get("ISS151"), item.get("ISS152"), item.get("ISS153"),
                            item.get("ISS154"), item.get("ISS155"), item.get("ISS156"), item.get("ISS157"),
                            item.get("ISS158"), item.get("ISS159"),
                            item.get("ISS160"), item.get("ISS161"), item.get("ISS162"),
                            item.get("ISS163"), item.get("ISS164"), item.get("ISS165"), item.get("ISS166"),
                            item.get("ISS167"), item.get("ISI168"),
                            item.get("ISI169"), item.get("ISI170"), item.get("ISI171"),
                            item.get("ISI172"), item.get("ISI173"), item.get("ISS174"), item.get("ISI175"),
                            item.get("ISI176"), item.get("ISI177"),
                            item.get("ISI178"), item.get("ISI179"), item.get("ISI180")] for item in data])
    print("Done insert data table stx_fsc_incomestatement / Financial", datetime.now().strftime('%Y-%m-%d %H:%M:%S'))
    telegram.send(mess=f"Done insert data table stx_fsc_incomestatement / Financial / Data size: {len(data)}")
